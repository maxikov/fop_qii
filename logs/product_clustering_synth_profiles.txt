Loading results dict
Loading indicators
Loading ALS model
Loading movies
Done, 27278 movies loaded
Training kmeans
Done
Centroids: [array([-0.36139909,  0.06625926, -0.55550655, -0.10448825,  0.58637465,
       -0.16191049, -0.57481061,  0.15506568,  0.49511679,  0.13280655,
        0.22786175,  1.49151507]), array([-0.39418402, -0.29691561, -0.57439298,  0.54492337,  0.82295083,
       -0.22440649, -0.59247407, -0.5005708 ,  0.95943208, -0.44237367,
        0.06431223,  0.71851755]), array([-0.31969924, -0.1634654 , -0.2928501 ,  0.397291  ,  0.47590439,
       -0.63621889, -0.64499017, -0.08575314,  0.83169554, -0.58155077,
        0.34800232,  1.2980087 ]), array([-0.22144107, -0.04640868, -1.00597355,  0.0016615 ,  0.80945641,
       -1.30861715,  0.2269242 ,  0.03501376,  1.01661066, -0.66749805,
        0.38453074,  0.80647987]), array([ 0.19288976, -0.29214763, -0.13348078,  0.51873634,  0.09397842,
       -0.82439199, -0.7781879 ,  0.26951319,  1.1068002 , -0.16405218,
        0.0272013 ,  0.62377725]), array([ 0.07576142,  0.61635059, -0.80127173,  0.10241596,  0.14206927,
       -0.26406668, -0.79708385,  0.03581438,  0.83368235, -0.70638042,
        0.63798405,  1.03932652]), array([-0.10520302, -0.07303479, -0.25197659, -0.0133001 ,  0.22468217,
       -0.2845844 , -0.19491836, -0.10124465,  0.45368326, -0.202581  ,
        0.07634379,  0.54378324]), array([-0.42056236, -0.20525456, -0.39089288, -0.03644794,  0.55132512,
        0.02407895, -0.05150457,  0.2280073 ,  0.61926771, -0.63959354,
        0.46010347,  1.28893527]), array([ 0.05293534,  0.26711107, -0.41992842, -0.00172703,  0.05818782,
       -0.1768784 , -0.42253184, -0.04325047,  0.50918392, -0.37673709,
        0.2863966 ,  0.51114872]), array([ 0.13381522, -0.27026536, -0.20411388,  0.47140585,  0.14404162,
       -0.78417435, -0.7832634 ,  0.20656469,  1.07632527, -0.20888848,
        0.04557972,  0.723995  ]), array([-0.00301694, -0.10883997, -0.10564916, -0.46974139,  0.16770462,
       -0.67057359, -0.21874356, -0.83472541,  1.66552268, -0.41856508,
        0.09812047,  0.9712696 ]), array([-0.43546631,  0.06381532,  0.01015998,  0.18019683,  0.24056515,
       -0.71314922, -0.40610434, -0.1776759 ,  0.23101353, -0.66835306,
        0.52682477,  1.43210494]), array([ 0.3228364 , -0.51339676, -0.66204788,  0.27707491, -0.12810598,
       -0.29066238, -0.54698378, -0.31280274,  0.85834039, -0.56801576,
       -0.81998797,  1.15030791]), array([-0.17167962, -0.52469277, -0.50746568, -0.66681331, -0.0752192 ,
       -0.89606081, -1.09185656, -0.16462817,  0.67917667, -0.55265056,
        0.07508227,  0.87435806]), array([ 0.15395039, -0.43041256, -0.67247922,  0.26169221,  0.04555531,
       -0.47485298, -0.74513043, -0.25957202,  0.96855849, -0.5876366 ,
       -0.48388386,  1.26572892])]
Labeling clusters
Centroid mean: [-0.10003087 -0.12741986 -0.43785796  0.09752533  0.27729804 -0.51243126
 -0.50811062 -0.10334962  0.82029397 -0.44347131  0.13029811  0.98261711]
Centroid variance: 1.12054950958
Cluster 9 (variance: 0.0348484508835):
	0: (dist: 0.0297678116274) Some Girls (1988) (mid: 4668)
	1: (dist: 0.0299656422792) Fright Night (1985) (mid: 2867)
	2: (dist: 0.0310134965525) Man Who Would Be King, The (1975) (mid: 1303)
	3: (dist: 0.0316527013226) House with Laughing Windows, The (Casa dalle finestre che ridono, La) (1976) (mid: 6256)
	4: (dist: 0.0316527013226) Diary of a Nymphomaniac (Diario de una Ninfómana) (2008) (mid: 77810)
	5: (dist: 0.0316527013226) House of Sand and Fog (2003) (mid: 7158)
	6: (dist: 0.0316527013226) Birth (2004) (mid: 8959)
	7: (dist: 0.0316527013226) Naked Lunch (1991) (mid: 7123)
	8: (dist: 0.0316527013226) Sex and Lucia (Lucía y el sexo) (2001) (mid: 5477)
	9: (dist: 0.0316527013226) About Schmidt (2002) (mid: 5945)
Cluster 4 (variance: 0.0574316328454):
	0: (dist: 0.0939825597818) Only Lovers Left Alive (2013) (mid: 107771)
	1: (dist: 0.0941437790767) Cronos (1993) (mid: 565)
	2: (dist: 0.0998845070198) Reader, The (2008) (mid: 64622)
	3: (dist: 0.100450192714) Stonewall (1995) (mid: 831)
	4: (dist: 0.10123825244) Keep the River on Your Right: A Modern Cannibal Tale (2000) (mid: 4236)
	5: (dist: 0.101316532575) Come Undone (Presque Rien) (2000) (mid: 5024)
	6: (dist: 0.102718936725) Wedding Crashers (2005) (mid: 34162)
	7: (dist: 0.104181617291) Like Water for Chocolate (Como agua para chocolate) (1992) (mid: 265)
	8: (dist: 0.104849816857) Trouble Every Day (2001) (mid: 5153)
	9: (dist: 0.104899133234) Counterfeiters, The (Die Fälscher) (2007) (mid: 58303)
Cluster 7 (variance: 0.0720416128082):
	0: (dist: 0.0452113191308) Negotiator, The (1998) (mid: 2058)
	1: (dist: 0.0509644990757) Battle for the Planet of the Apes (1973) (mid: 2531)
	2: (dist: 0.0526795273627) Brick Mansions (2014) (mid: 110826)
	3: (dist: 0.054004764571) D.O.A. (1950) (mid: 7223)
	4: (dist: 0.054004764571) Substitute, The (1996) (mid: 694)
	5: (dist: 0.054004764571) Assault on Precinct 13 (2005) (mid: 31420)
	6: (dist: 0.054004764571) Hoodlum (1997) (mid: 1601)
	7: (dist: 0.0549846763638) End of Days (1999) (mid: 3113)
	8: (dist: 0.0552264579654) Octagon, The (1980) (mid: 5212)
	9: (dist: 0.055960028798) Matrix, The (1999) (mid: 2571)
Cluster 8 (variance: 0.109098717634):
	0: (dist: 0.124622515488) Cloverfield (2008) (mid: 57368)
	1: (dist: 0.127914760595) Raiders of the Lost Ark (Indiana Jones and the Raiders of the Lost Ark) (1981) (mid: 1198)
	2: (dist: 0.148933412523) Megan Is Missing (2011) (mid: 87909)
	3: (dist: 0.152067212215) Poseidon Adventure, The (1972) (mid: 2013)
	4: (dist: 0.155063679414) Mean Streets (1973) (mid: 8042)
	5: (dist: 0.156004341297) Married to the Mob (1988) (mid: 2247)
	6: (dist: 0.156613783103) Dead Snow (Død snø) (2009) (mid: 69275)
	7: (dist: 0.159215001948) Jurassic Park (1993) (mid: 480)
	8: (dist: 0.159432598248) Queen of the Damned (2002) (mid: 5128)
	9: (dist: 0.160066234184) Pacific Rim (2013) (mid: 103228)
Cluster 12 (variance: 0.114236294588):
	0: (dist: 0.0310023563114) My Girl 2 (1994) (mid: 5969)
	1: (dist: 0.0311033409743) How to Kill Your Neighbor's Dog (2000) (mid: 5131)
	2: (dist: 0.0315292176997) Dream for an Insomniac (1996) (mid: 1902)
	3: (dist: 0.0320608792332) Mumford (1999) (mid: 2883)
	4: (dist: 0.0320880762634) Call Me Madam (1953) (mid: 79667)
	5: (dist: 0.0331848548645) It's Always Fair Weather (1955) (mid: 26001)
	6: (dist: 0.0336423622231) Apartment, The (Appartement, L') (1996) (mid: 6789)
	7: (dist: 0.033822532483) Looking for Palladin (2008) (mid: 103135)
	8: (dist: 0.0340284167456) Producers, The (2005) (mid: 42002)
	9: (dist: 0.0340477183955) Star Is Born, A (1954) (mid: 25996)
Cluster 11 (variance: 0.207331294095):
	0: (dist: 0.12724770353) Witness (1985) (mid: 1674)
	1: (dist: 0.129009765817) Girl with the Dragon Tattoo, The (2011) (mid: 91658)
	2: (dist: 0.130134475152) Sleuth (2007) (mid: 55278)
	3: (dist: 0.13397114472) North by Northwest (1959) (mid: 908)
	4: (dist: 0.13623952674) Babar The Movie (1989) (mid: 126749)
	5: (dist: 0.14115962867) Adventures of Ichabod and Mr. Toad, The (1949) (mid: 3964)
	6: (dist: 0.147469003837) Body Double (1984) (mid: 7616)
	7: (dist: 0.151184720935) Firefox (1982) (mid: 6078)
	8: (dist: 0.153334340661) Ewoks: The Battle for Endor (1985) (mid: 26542)
	9: (dist: 0.153684076054) Play Dirty (1969) (mid: 79388)
Cluster 0 (variance: 0.232290469997):
	0: (dist: 0.125731518153) Walking Tall (1973) (mid: 26309)
	1: (dist: 0.134677346585) In the Cut (2003) (mid: 6885)
	2: (dist: 0.13602890643) Resurrection, A (2013) (mid: 111142)
	3: (dist: 0.13602890643) Mechanic, The (2011) (mid: 85020)
	4: (dist: 0.13602890643) Texas Chainsaw 3D (2013) (mid: 99721)
	5: (dist: 0.136670121294) Big Nothing (2006) (mid: 52606)
	6: (dist: 0.140377944912) Death Race 2 (2010) (mid: 88699)
	7: (dist: 0.143332049379) Curious Case of Benjamin Button, The (2008) (mid: 64957)
	8: (dist: 0.154853535805) Hot Rod (2007) (mid: 54256)
	9: (dist: 0.159374040113) Coffy (1973) (mid: 4064)
Cluster 1 (variance: 0.252934592152):
	0: (dist: 0.122488420247) Felicia's Journey (1999) (mid: 3055)
	1: (dist: 0.125055376996) Better Luck Tomorrow (2002) (mid: 6288)
	2: (dist: 0.127361284928) Pierrot le fou (1965) (mid: 7748)
	3: (dist: 0.128708399762) Safety Not Guaranteed (2012) (mid: 95088)
	4: (dist: 0.128957165366) City Island (2009) (mid: 71466)
	5: (dist: 0.13015482534) Odd Man Out (1947) (mid: 25930)
	6: (dist: 0.130774808392) Captain Conan (Capitaine Conan) (1996) (mid: 79830)
	7: (dist: 0.131140313854) Chronicle (2012) (mid: 92420)
	8: (dist: 0.131269129165) Company You Keep, The (2012) (mid: 99741)
	9: (dist: 0.132658749525) Savannah Smiles (1982) (mid: 6124)
Cluster 13 (variance: 0.328920619453):
	0: (dist: 0.126350524332) Turn Me On, Dammit! (Få meg på, for faen) (2011) (mid: 92152)
	1: (dist: 0.127999870913) Ghajini (2008) (mid: 83424)
	2: (dist: 0.139139073649) Story of Three Loves, The (1953) (mid: 82235)
	3: (dist: 0.139263065371) Thousand Clouds of Peace, A (Mil nubes de paz cercan el cielo, amor, jamás acabarás de ser amor) (2003) (mid: 7441)
	4: (dist: 0.139746246346) Beguiled, The (1971) (mid: 26240)
	5: (dist: 0.139923999206) Tea and Sympathy (1956) (mid: 53916)
	6: (dist: 0.140174073494) Holiday, The (2006) (mid: 49286)
	7: (dist: 0.141127222141) Bitter Tears of Petra von Kant, The (bitteren Tränen der Petra von Kant, Die) (1972) (mid: 31524)
	8: (dist: 0.141212255149) Another Year (2010) (mid: 82463)
	9: (dist: 0.141268060953) Be with Me (2005) (mid: 51103)
Cluster 6 (variance: 0.353061078418):
	0: (dist: 0.40061437216) Beautiful Mind, A (2001) (mid: 4995)
	1: (dist: 0.405792791877) Spontaneous Combustion (1990) (mid: 118344)
	2: (dist: 0.419117416744) Congo (1995) (mid: 160)
	3: (dist: 0.423911004757) Man from Earth, The (2007) (mid: 55908)
	4: (dist: 0.426936978835) Left Behind: The Movie (2000) (mid: 4142)
	5: (dist: 0.429552631031) Mogambo (1953) (mid: 7822)
	6: (dist: 0.434541072368) Kitchen Stories (Salmer fra kjøkkenet) (2003) (mid: 7297)
	7: (dist: 0.439508123824) Alice, Sweet Alice (a.k.a. Communion) (a.k.a. Holy Terror) (1976) (mid: 2853)
	8: (dist: 0.439627605389) Notorious (1946) (mid: 930)
	9: (dist: 0.440531864008) 2001: A Space Odyssey (1968) (mid: 924)
Cluster 10 (variance: 0.371075397627):
	0: (dist: 0.109338247802) Days of Heaven (1978) (mid: 2932)
	1: (dist: 0.119895296923) Blue Steel (1990) (mid: 5961)
	2: (dist: 0.120171133157) Philadelphia Story, The (1940) (mid: 898)
	3: (dist: 0.12092082869) Karate Kid, The (1984) (mid: 2420)
	4: (dist: 0.121130236706) Two-Lane Blacktop (1971) (mid: 6229)
	5: (dist: 0.122079856811) My Man Godfrey (1936) (mid: 947)
	6: (dist: 0.123124258885) Fear (1996) (mid: 662)
	7: (dist: 0.123407124469) Skulls, The (2000) (mid: 3484)
	8: (dist: 0.123526384149) Pygmalion (1938) (mid: 7086)
	9: (dist: 0.124113514043) Scandal (1989) (mid: 4659)
Cluster 5 (variance: 0.383857394):
	0: (dist: 0.14548738643) American Hustle (2013) (mid: 106916)
	1: (dist: 0.176237007642) Everly (2014) (mid: 126575)
	2: (dist: 0.179234152671) Finding Vivian Maier (2013) (mid: 112399)
	3: (dist: 0.181572978863) Red Tails (2012) (mid: 92234)
	4: (dist: 0.185117142704) Undocumented (2010) (mid: 105815)
	5: (dist: 0.187177642782) Much Ado About Something (2001) (mid: 64427)
	6: (dist: 0.188722529365) They Call Me Bruce? (a.k.a. A Fistful of Chopsticks) (1982) (mid: 6141)
	7: (dist: 0.196957613925) Strictly Ballroom (1992) (mid: 1188)
	8: (dist: 0.19713523723) Hardware (1990) (mid: 34292)
	9: (dist: 0.197597422154) Stigmata (1999) (mid: 2840)
Cluster 3 (variance: 0.40026473536):
	0: (dist: 0.131553590855) Port of Shadows (Quai des brumes) (1938) (mid: 8786)
	1: (dist: 0.149001701908) O Brother, Where Art Thou? (2000) (mid: 4027)
	2: (dist: 0.149598276595) Others, The (2001) (mid: 4720)
	3: (dist: 0.152160518596) Harrison's Flowers (2000) (mid: 5221)
	4: (dist: 0.152655591475) South Park: Bigger, Longer and Uncut (1999) (mid: 2700)
	5: (dist: 0.152993914514) Sniper, The (1952) (mid: 78186)
	6: (dist: 0.156371965037) Suspect Zero (2004) (mid: 8831)
	7: (dist: 0.157527594577) Murder by Contract (1958) (mid: 72327)
	8: (dist: 0.158463760407) Orlando (1992) (mid: 506)
	9: (dist: 0.159372665486) Wake of the Red Witch (1948) (mid: 6276)
Cluster 2 (variance: 0.410913213183):
	0: (dist: 0.28083878231) King of New York (1990) (mid: 1785)
	1: (dist: 0.292271481042) Brannigan (1975) (mid: 4853)
	2: (dist: 0.29347342143) September Dawn (2007) (mid: 54783)
	3: (dist: 0.306286364136) Shaft (1971) (mid: 3729)
	4: (dist: 0.306897723714) Black Book (Zwartboek) (2006) (mid: 52042)
	5: (dist: 0.30847674562) First Blood (Rambo: First Blood) (1982) (mid: 2403)
	6: (dist: 0.320055135721) Day of the Jackal, The (1973) (mid: 8207)
	7: (dist: 0.366346145499) Danger: Diabolik (Diabolik) (1968) (mid: 33861)
	8: (dist: 0.389203589864) Bright Young Things (2003) (mid: 27648)
	9: (dist: 0.394080647306) Before the Devil Knows You're Dead (2007) (mid: 55805)
Cluster 14 (variance: 0.474421921276):
	0: (dist: 0.286491105635) Forgetting Sarah Marshall (2008) (mid: 58998)
	1: (dist: 0.300263745066) All Over the Guy (2001) (mid: 4722)
	2: (dist: 0.301147427619) Something's Gotta Give (2003) (mid: 7149)
	3: (dist: 0.302399027645) Star Maker, The (Uomo delle stelle, L') (1995) (mid: 124)
	4: (dist: 0.30643196348) Governess, The (1998) (mid: 2062)
	5: (dist: 0.308065675693) Synecdoche, New York (2008) (mid: 62511)
	6: (dist: 0.308392291539) For Ever Mozart (1996) (mid: 1579)
	7: (dist: 0.308453523534) My Wife is an Actress (Ma Femme est une Actrice) (2001) (mid: 5466)
	8: (dist: 0.308752773999) Sex Is Comedy (2002) (mid: 27564)
	9: (dist: 0.308846939423) Hamlet 2 (2008) (mid: 61246)
Training a latent tree
DecisionTreeModel classifier of depth 8 with 209 nodes
  If (feature 3 <= 0.3375222980976105)
   If (feature 11 <= 0.8188146352767944)
    If (feature 9 <= -0.3356432318687439)
     If (feature 3 <= -0.32372191548347473)
      If (feature 6 <= -0.795111894607544)
       Predict: 13.0
      Else (feature 6 > -0.795111894607544)
       Predict: 10.0
     Else (feature 3 > -0.32372191548347473)
      If (feature 6 <= -0.34838151931762695)
       If (feature 0 <= 0.1872040331363678)
        If (feature 1 <= -0.1518182009458542)
         If (feature 3 <= -0.12415862083435059)
          Predict: 6.0
         Else (feature 3 > -0.12415862083435059)
          Predict: 1.0
        Else (feature 1 > -0.1518182009458542)
         If (feature 3 <= 0.22021420300006866)
          Predict: 8.0
         Else (feature 3 > 0.22021420300006866)
          Predict: 5.0
       Else (feature 0 > 0.1872040331363678)
        If (feature 1 <= -0.08141183108091354)
         Predict: 14.0
        Else (feature 1 > -0.08141183108091354)
         Predict: 5.0
      Else (feature 6 > -0.34838151931762695)
       If (feature 4 <= 0.4898626208305359)
        If (feature 8 <= 0.8230462670326233)
         If (feature 1 <= 0.14954878389835358)
          Predict: 6.0
         Else (feature 1 > 0.14954878389835358)
          Predict: 8.0
        Else (feature 8 > 0.8230462670326233)
         If (feature 1 <= -0.2277180403470993)
          Predict: 10.0
         Else (feature 1 > -0.2277180403470993)
          Predict: 9.0
       Else (feature 4 > 0.4898626208305359)
        If (feature 5 <= -0.5313830375671387)
         Predict: 3.0
        Else (feature 5 > -0.5313830375671387)
         Predict: 1.0
    Else (feature 9 > -0.3356432318687439)
     If (feature 8 <= 0.9093350768089294)
      If (feature 1 <= 0.14954878389835358)
       If (feature 6 <= -0.608093798160553)
        If (feature 0 <= 0.027416324242949486)
         Predict: 13.0
        Else (feature 0 > 0.027416324242949486)
         Predict: 9.0
       Else (feature 6 > -0.608093798160553)
        If (feature 7 <= -0.492097407579422)
         Predict: 1.0
        Else (feature 7 > -0.492097407579422)
         If (feature 7 <= 0.13509425520896912)
          Predict: 6.0
         Else (feature 7 > 0.13509425520896912)
          Predict: 6.0
      Else (feature 1 > 0.14954878389835358)
       If (feature 10 <= 0.13258890807628632)
        Predict: 6.0
       Else (feature 10 > 0.13258890807628632)
        Predict: 8.0
     Else (feature 8 > 0.9093350768089294)
      If (feature 3 <= -0.08992959558963776)
       Predict: 10.0
      Else (feature 3 > -0.08992959558963776)
       If (feature 2 <= -0.2934306859970093)
        If (feature 0 <= 0.0745120719075203)
         Predict: 9.0
        Else (feature 0 > 0.0745120719075203)
         Predict: 5.0
       Else (feature 2 > -0.2934306859970093)
        Predict: 4.0
   Else (feature 11 > 0.8188146352767944)
    If (feature 6 <= -0.2545810341835022)
     If (feature 1 <= 0.38039135932922363)
      If (feature 9 <= -0.23477725684642792)
       If (feature 8 <= 0.5162776112556458)
        If (feature 1 <= -0.13502968847751617)
         If (feature 6 <= -0.786186158657074)
          Predict: 13.0
         Else (feature 6 > -0.786186158657074)
          Predict: 6.0
        Else (feature 1 > -0.13502968847751617)
         If (feature 0 <= -0.18153229355812073)
          Predict: 11.0
         Else (feature 0 > -0.18153229355812073)
          Predict: 6.0
       Else (feature 8 > 0.5162776112556458)
        If (feature 10 <= -0.525442361831665)
         If (feature 5 <= -0.4459073841571808)
          Predict: 13.0
         Else (feature 5 > -0.4459073841571808)
          Predict: 12.0
        Else (feature 10 > -0.525442361831665)
         If (feature 6 <= -0.9203681945800781)
          Predict: 13.0
         Else (feature 6 > -0.9203681945800781)
          Predict: 10.0
      Else (feature 9 > -0.23477725684642792)
       If (feature 7 <= -0.11928808689117432)
        If (feature 4 <= 0.5976402163505554)
         If (feature 8 <= 1.0553674697875977)
          Predict: 0.0
         Else (feature 8 > 1.0553674697875977)
          Predict: 10.0
        Else (feature 4 > 0.5976402163505554)
         Predict: 1.0
       Else (feature 7 > -0.11928808689117432)
        If (feature 11 <= 0.9396129250526428)
         If (feature 1 <= 0.14954878389835358)
          Predict: 6.0
         Else (feature 1 > 0.14954878389835358)
          Predict: 5.0
        Else (feature 11 > 0.9396129250526428)
         If (feature 1 <= -0.31239601969718933)
          Predict: 13.0
         Else (feature 1 > -0.31239601969718933)
          Predict: 0.0
     Else (feature 1 > 0.38039135932922363)
      If (feature 10 <= -0.027090197429060936)
       Predict: 0.0
      Else (feature 10 > -0.027090197429060936)
       If (feature 2 <= -0.34359073638916016)
        Predict: 5.0
       Else (feature 2 > -0.34359073638916016)
        Predict: 10.0
    Else (feature 6 > -0.2545810341835022)
     If (feature 5 <= -0.28441616892814636)
      If (feature 7 <= -0.5939164757728577)
       Predict: 10.0
      Else (feature 7 > -0.5939164757728577)
       If (feature 5 <= -0.9205377697944641)
        Predict: 3.0
       Else (feature 5 > -0.9205377697944641)
        If (feature 0 <= -0.40699562430381775)
         Predict: 11.0
        Else (feature 0 > -0.40699562430381775)
         Predict: 0.0
     Else (feature 5 > -0.28441616892814636)
      If (feature 10 <= 0.25378933548927307)
       If (feature 1 <= -0.0532095767557621)
        If (feature 4 <= -0.0791676938533783)
         Predict: 12.0
        Else (feature 4 > -0.0791676938533783)
         If (feature 7 <= 0.09804827719926834)
          Predict: 1.0
         Else (feature 7 > 0.09804827719926834)
          Predict: 0.0
       Else (feature 1 > -0.0532095767557621)
        Predict: 6.0
      Else (feature 10 > 0.25378933548927307)
       If (feature 7 <= -0.20018945634365082)
        If (feature 0 <= -0.5131211876869202)
         Predict: 1.0
        Else (feature 0 > -0.5131211876869202)
         If (feature 0 <= -0.21923287212848663)
          Predict: 6.0
         Else (feature 0 > -0.21923287212848663)
          Predict: 10.0
       Else (feature 7 > -0.20018945634365082)
        If (feature 9 <= -0.2660880982875824)
         Predict: 7.0
        Else (feature 9 > -0.2660880982875824)
         Predict: 0.0
  Else (feature 3 > 0.3375222980976105)
   If (feature 4 <= 0.4141198694705963)
    If (feature 11 <= 0.6838681697845459)
     If (feature 5 <= -0.690338671207428)
      If (feature 2 <= -0.18296314775943756)
       If (feature 11 <= 0.6379770636558533)
        If (feature 9 <= -0.3356432318687439)
         If (feature 0 <= 0.3161312937736511)
          Predict: 9.0
         Else (feature 0 > 0.3161312937736511)
          Predict: 5.0
        Else (feature 9 > -0.3356432318687439)
         If (feature 0 <= 0.1263042688369751)
          Predict: 9.0
         Else (feature 0 > 0.1263042688369751)
          Predict: 4.0
       Else (feature 11 > 0.6379770636558533)
        Predict: 9.0
      Else (feature 2 > -0.18296314775943756)
       If (feature 7 <= 0.13509425520896912)
        If (feature 0 <= 0.1355176866054535)
         Predict: 9.0
        Else (feature 0 > 0.1355176866054535)
         Predict: 4.0
       Else (feature 7 > 0.13509425520896912)
        If (feature 0 <= 0.10020816326141357)
         If (feature 5 <= -0.8197575211524963)
          Predict: 4.0
         Else (feature 5 > -0.8197575211524963)
          Predict: 9.0
        Else (feature 0 > 0.10020816326141357)
         Predict: 4.0
     Else (feature 5 > -0.690338671207428)
      If (feature 1 <= -0.1518182009458542)
       Predict: 9.0
      Else (feature 1 > -0.1518182009458542)
       If (feature 0 <= 0.10020816326141357)
        Predict: 8.0
       Else (feature 0 > 0.10020816326141357)
        Predict: 5.0
    Else (feature 11 > 0.6838681697845459)
     If (feature 9 <= -0.36306941509246826)
      If (feature 10 <= -0.15666377544403076)
       If (feature 0 <= 0.3161312937736511)
        If (feature 5 <= -0.17204776406288147)
         If (feature 7 <= -0.6166050434112549)
          Predict: 12.0
         Else (feature 7 > -0.6166050434112549)
          Predict: 14.0
        Else (feature 5 > -0.17204776406288147)
         Predict: 12.0
       Else (feature 0 > 0.3161312937736511)
        If (feature 6 <= -0.8041403889656067)
         If (feature 2 <= -0.6588954925537109)
          Predict: 14.0
         Else (feature 2 > -0.6588954925537109)
          Predict: 12.0
        Else (feature 6 > -0.8041403889656067)
         Predict: 12.0
      Else (feature 10 > -0.15666377544403076)
       If (feature 1 <= 0.013995500281453133)
        If (feature 0 <= -0.021083103492856026)
         Predict: 2.0
        Else (feature 0 > -0.021083103492856026)
         Predict: 9.0
       Else (feature 1 > 0.013995500281453133)
        If (feature 8 <= 0.5162776112556458)
         Predict: 11.0
        Else (feature 8 > 0.5162776112556458)
         If (feature 0 <= -0.2804836630821228)
          Predict: 2.0
         Else (feature 0 > -0.2804836630821228)
          Predict: 5.0
     Else (feature 9 > -0.36306941509246826)
      If (feature 0 <= 0.1872040331363678)
       If (feature 6 <= -0.6557168960571289)
        Predict: 9.0
       Else (feature 6 > -0.6557168960571289)
        If (feature 0 <= 0.10020816326141357)
         Predict: 4.0
        Else (feature 0 > 0.10020816326141357)
         Predict: 14.0
      Else (feature 0 > 0.1872040331363678)
       If (feature 7 <= 0.19794197380542755)
        If (feature 2 <= -0.5041176676750183)
         If (feature 1 <= -0.38912373781204224)
          Predict: 12.0
         Else (feature 1 > -0.38912373781204224)
          Predict: 14.0
        Else (feature 2 > -0.5041176676750183)
         Predict: 9.0
       Else (feature 7 > 0.19794197380542755)
        Predict: 4.0
   Else (feature 4 > 0.4141198694705963)
    If (feature 10 <= 0.29384130239486694)
     If (feature 7 <= -0.11928808689117432)
      If (feature 5 <= -0.748224675655365)
       If (feature 0 <= -0.33492395281791687)
        Predict: 2.0
       Else (feature 0 > -0.33492395281791687)
        If (feature 0 <= -0.21923287212848663)
         Predict: 3.0
        Else (feature 0 > -0.21923287212848663)
         Predict: 1.0
      Else (feature 5 > -0.748224675655365)
       If (feature 11 <= 1.303977608680725)
        Predict: 1.0
       Else (feature 11 > 1.303977608680725)
        If (feature 0 <= -0.5131211876869202)
         Predict: 1.0
        Else (feature 0 > -0.5131211876869202)
         Predict: 2.0
     Else (feature 7 > -0.11928808689117432)
      If (feature 11 <= 1.0896718502044678)
       If (feature 1 <= -0.30042243003845215)
        Predict: 1.0
       Else (feature 1 > -0.30042243003845215)
        Predict: 3.0
      Else (feature 11 > 1.0896718502044678)
       If (feature 2 <= -0.7471752762794495)
        If (feature 0 <= -0.5131211876869202)
         Predict: 0.0
        Else (feature 0 > -0.5131211876869202)
         Predict: 14.0
       Else (feature 2 > -0.7471752762794495)
        Predict: 2.0
    Else (feature 10 > 0.29384130239486694)
     If (feature 2 <= -0.7471752762794495)
      Predict: 5.0
     Else (feature 2 > -0.7471752762794495)
      If (feature 5 <= -0.33266475796699524)
       If (feature 6 <= -0.409036248922348)
        If (feature 7 <= -0.24569159746170044)
         If (feature 8 <= 0.32790353894233704)
          Predict: 11.0
         Else (feature 8 > 0.32790353894233704)
          Predict: 2.0
        Else (feature 7 > -0.24569159746170044)
         Predict: 1.0
       Else (feature 6 > -0.409036248922348)
        If (feature 0 <= -0.33492395281791687)
         Predict: 3.0
        Else (feature 0 > -0.33492395281791687)
         Predict: 10.0
      Else (feature 5 > -0.33266475796699524)
       Predict: 1.0

Done, making predictions
Accuracy: 0.961807289066
/opt/spark-2.1.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/mllib/evaluation.py:237: UserWarning: Deprecated in 2.0.0. Use accuracy.
/opt/spark-2.1.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/mllib/evaluation.py:249: UserWarning: Deprecated in 2.0.0. Use accuracy.
/opt/spark-2.1.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/mllib/evaluation.py:262: UserWarning: Deprecated in 2.0.0. Use accuracy.
Summary Stats
Precision = 0.961807289066
Recall = 0.961807289066
F1 Score = 0.961807289066
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 153 nodes
  If (average_rating <= 2.0)
   If (Isn't tvtropes:too dumb to live)
    If (year <= 2014.0)
     Predict: 6.0
    Else (year > 2014.0)
     If (Isn't imdb_keywords:african-american)
      Predict: 6.0
     Else (Is imdb_keywords:african-american)
      Predict: 8.0
   Else (Is tvtropes:too dumb to live)
    If (Isn't imdb_keywords:topless-female-nudity)
     If (Isn't imdb_keywords:long-take)
      Predict: 8.0
     Else (Is imdb_keywords:long-take)
      Predict: 6.0
    Else (Is imdb_keywords:topless-female-nudity)
     Predict: 6.0
  Else (average_rating > 2.0)
   If (Isn't imdb_keywords:robbery)
    If (Isn't imdb_keywords:male-nudity)
     If (Isn't imdb_keywords:disguise)
      If (Isn't imdb_keywords:gunfight)
       If (Isn't imdb_keywords:actress)
        If (Isn't imdb_keywords:class-differences)
         If (Isn't imdb_keywords:unrequited-love)
          Predict: 0.0
         Else (Is imdb_keywords:unrequited-love)
          Predict: 13.0
        Else (Is imdb_keywords:class-differences)
         If (Isn't imdb_keywords:gunfire)
          Predict: 10.0
         Else (Is imdb_keywords:gunfire)
          Predict: 3.0
       Else (Is imdb_keywords:actress)
        If (Isn't imdb_keywords:class-differences)
         If (Isn't imdb_keywords:unrequited-love)
          Predict: 12.0
         Else (Is imdb_keywords:unrequited-love)
          Predict: 14.0
        Else (Is imdb_keywords:class-differences)
         Predict: 10.0
      Else (Is imdb_keywords:gunfight)
       If (Isn't imdb_keywords:hit-by-a-car)
        If (Isn't imdb_keywords:subtitled-scene)
         If (Isn't imdb_keywords:gunfire)
          Predict: 7.0
         Else (Is imdb_keywords:gunfire)
          Predict: 3.0
        Else (Is imdb_keywords:subtitled-scene)
         If (Isn't tvtropes:heroic sacrifice)
          Predict: 5.0
         Else (Is tvtropes:heroic sacrifice)
          Predict: 7.0
       Else (Is imdb_keywords:hit-by-a-car)
        If (Isn't imdb_keywords:subtitled-scene)
         If (Isn't imdb_keywords:unrequited-love)
          Predict: 0.0
         Else (Is imdb_keywords:unrequited-love)
          Predict: 13.0
        Else (Is imdb_keywords:subtitled-scene)
         If (Isn't movielens_tags:BD-Video)
          Predict: 5.0
         Else (Is movielens_tags:BD-Video)
          Predict: 3.0
     Else (Is imdb_keywords:disguise)
      If (Isn't imdb_keywords:subtitled-scene)
       If (Isn't imdb_keywords:gunfire)
        If (Isn't imdb_keywords:unrequited-love)
         If (Isn't imdb_keywords:actress)
          Predict: 11.0
         Else (Is imdb_keywords:actress)
          Predict: 14.0
        Else (Is imdb_keywords:unrequited-love)
         If (Isn't imdb_keywords:actress)
          Predict: 13.0
         Else (Is imdb_keywords:actress)
          Predict: 14.0
       Else (Is imdb_keywords:gunfire)
        Predict: 3.0
      Else (Is imdb_keywords:subtitled-scene)
       If (Isn't tvtropes:too dumb to live)
        If (Isn't imdb_keywords:cow)
         If (Isn't movielens_tags:nudity (full frontal))
          Predict: 5.0
         Else (Is movielens_tags:nudity (full frontal))
          Predict: 14.0
        Else (Is imdb_keywords:cow)
         Predict: 3.0
       Else (Is tvtropes:too dumb to live)
        Predict: 11.0
    Else (Is imdb_keywords:male-nudity)
     If (average_rating <= 3.9130434782608696)
      If (Isn't imdb_keywords:topless-female-nudity)
       If (average_rating <= 2.9473684210526314)
        If (Isn't imdb_keywords:child-in-peril)
         If (Isn't imdb_keywords:gunfight)
          Predict: 4.0
         Else (Is imdb_keywords:gunfight)
          Predict: 2.0
        Else (Is imdb_keywords:child-in-peril)
         If (Isn't imdb_keywords:cruelty)
          Predict: 9.0
         Else (Is imdb_keywords:cruelty)
          Predict: 2.0
       Else (average_rating > 2.9473684210526314)
        If (Isn't imdb_keywords:actress)
         If (Isn't imdb_keywords:subtitled-scene)
          Predict: 4.0
         Else (Is imdb_keywords:subtitled-scene)
          Predict: 5.0
        Else (Is imdb_keywords:actress)
         If (Isn't imdb_keywords:pubic-hair)
          Predict: 12.0
         Else (Is imdb_keywords:pubic-hair)
          Predict: 14.0
      Else (Is imdb_keywords:topless-female-nudity)
       If (Isn't imdb_keywords:actress)
        If (Isn't imdb_keywords:unrequited-love)
         If (Isn't imdb_keywords:gunfight)
          Predict: 9.0
         Else (Is imdb_keywords:gunfight)
          Predict: 2.0
        Else (Is imdb_keywords:unrequited-love)
         Predict: 13.0
       Else (Is imdb_keywords:actress)
        If (Isn't imdb_keywords:nurse)
         If (year <= 1979.0)
          Predict: 9.0
         Else (year > 1979.0)
          Predict: 14.0
        Else (Is imdb_keywords:nurse)
         Predict: 12.0
     Else (average_rating > 3.9130434782608696)
      If (Isn't imdb_keywords:actress)
       If (Isn't imdb_keywords:gunfight)
        If (Isn't imdb_keywords:unrequited-love)
         If (Isn't imdb_keywords:disguise)
          Predict: 9.0
         Else (Is imdb_keywords:disguise)
          Predict: 2.0
        Else (Is imdb_keywords:unrequited-love)
         If (Isn't movielens_tags:BD-Video)
          Predict: 13.0
         Else (Is movielens_tags:BD-Video)
          Predict: 10.0
       Else (Is imdb_keywords:gunfight)
        If (Isn't imdb_keywords:subtitled-scene)
         If (Isn't imdb_keywords:1910s)
          Predict: 2.0
         Else (Is imdb_keywords:1910s)
          Predict: 3.0
        Else (Is imdb_keywords:subtitled-scene)
         Predict: 5.0
      Else (Is imdb_keywords:actress)
       If (Isn't imdb_keywords:storytelling)
        Predict: 14.0
       Else (Is imdb_keywords:storytelling)
        If (year <= 2005.0)
         Predict: 10.0
        Else (year > 2005.0)
         Predict: 12.0
   Else (Is imdb_keywords:robbery)
    If (Isn't imdb_keywords:disguise)
     If (Isn't imdb_keywords:actress)
      If (Isn't imdb_keywords:gunfire)
       If (Isn't imdb_keywords:class-differences)
        If (Isn't imdb_keywords:subtitled-scene)
         If (Isn't imdb_keywords:unrequited-love)
          Predict: 1.0
         Else (Is imdb_keywords:unrequited-love)
          Predict: 13.0
        Else (Is imdb_keywords:subtitled-scene)
         If (Isn't tvtropes:too dumb to live)
          Predict: 5.0
         Else (Is tvtropes:too dumb to live)
          Predict: 1.0
       Else (Is imdb_keywords:class-differences)
        If (year <= 2008.0)
         Predict: 10.0
        Else (year > 2008.0)
         Predict: 1.0
      Else (Is imdb_keywords:gunfire)
       If (Isn't imdb_keywords:1970s)
        Predict: 3.0
       Else (Is imdb_keywords:1970s)
        Predict: 9.0
     Else (Is imdb_keywords:actress)
      If (Isn't imdb_keywords:cook)
       If (Isn't imdb_keywords:writing)
        Predict: 14.0
       Else (Is imdb_keywords:writing)
        Predict: 12.0
      Else (Is imdb_keywords:cook)
       If (Isn't movielens_tags:Tumey's DVDs)
        Predict: 12.0
       Else (Is movielens_tags:Tumey's DVDs)
        Predict: 3.0
    Else (Is imdb_keywords:disguise)
     If (Isn't imdb_keywords:mansion)
      If (Isn't imdb_keywords:long-take)
       If (Isn't imdb_keywords:gunfire)
        If (Isn't imdb_keywords:hand-grenade)
         If (Isn't movielens_tags:In Netflix queue)
          Predict: 2.0
         Else (Is movielens_tags:In Netflix queue)
          Predict: 11.0
        Else (Is imdb_keywords:hand-grenade)
         If (Isn't movielens_genre:Drama)
          Predict: 5.0
         Else (Is movielens_genre:Drama)
          Predict: 2.0
       Else (Is imdb_keywords:gunfire)
        Predict: 3.0
      Else (Is imdb_keywords:long-take)
       Predict: 1.0
     Else (Is imdb_keywords:mansion)
      If (Isn't imdb_keywords:class-differences)
       If (Isn't imdb_keywords:subtitled-scene)
        If (Isn't imdb_keywords:1990s)
         If (Isn't movielens_tags:crime)
          Predict: 2.0
         Else (Is movielens_tags:crime)
          Predict: 11.0
        Else (Is imdb_keywords:1990s)
         Predict: 1.0
       Else (Is imdb_keywords:subtitled-scene)
        Predict: 5.0
      Else (Is imdb_keywords:class-differences)
       Predict: 10.0

Done, making predictions
Accuracy: 0.897403894159
Summary Stats
Precision = 0.897403894159
Recall = 0.897403894159
F1 Score = 0.897403894159
36 features used
15 clusters found
Processing cluster 0.0
Traceback (most recent call last):
  File "/longterm/sophiak/fop_qii/product_clustering.py", line 355, in <module>
    main()
  File "/longterm/sophiak/fop_qii/product_clustering.py", line 257, in main
    qiis = tree_qii.get_tree_qii(meta_tree, features, used_features)
  File "/longterm/sophiak/fop_qii/tree_qii.py", line 98, in get_tree_qii
    features_to_test=used_features)
  File "/longterm/sophiak/fop_qii/common_utils.py", line 103, in compute_regression_qii
    signed_error = mean_error(predobs, 1.0, float)
  File "/longterm/sophiak/fop_qii/common_utils.py", line 195, in mean_error
    return (predictionsAndRatings.map(map_f).reduce(add) / float(predictionsAndRatings.count())) ** (1.0/power)
  File "/opt/spark-2.1.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/rdd.py", line 834, in reduce
  File "/opt/spark-2.1.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/rdd.py", line 808, in collect
  File "/opt/spark-2.1.1-bin-hadoop2.7/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py", line 1131, in __call__
  File "/opt/spark-2.1.1-bin-hadoop2.7/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py", line 883, in send_command
  File "/opt/spark-2.1.1-bin-hadoop2.7/python/lib/py4j-0.10.4-src.zip/py4j/java_gateway.py", line 1028, in send_command
  File "/usr/lib/python2.7/socket.py", line 451, in readline
    data = self._sock.recv(self._rbufsize)
  File "/opt/spark-2.1.1-bin-hadoop2.7/python/lib/pyspark.zip/pyspark/context.py", line 239, in signal_handler
KeyboardInterrupt
