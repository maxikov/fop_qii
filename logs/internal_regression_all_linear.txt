2017-05-12 09:58:03,059 - __main__ - DEBUG - rank: 3, lmbda: 0.02, num_iter: 300, num_partitions: 7
2017-05-12 09:58:03,059 - __main__ - DEBUG - data_path: datasets/ml-20m/, checkpoint_dir: /home/maxikov/spark_dir
2017-05-12 09:58:03,059 - __main__ - DEBUG - Temp dir: /home/maxikov/spark_dir
2017-05-12 09:58:03,059 - __main__ - DEBUG - local_threads: *
2017-05-12 09:58:03,059 - __main__ - DEBUG - spark_executor_memory: 15g
2017-05-12 09:58:03,059 - __main__ - DEBUG - regression_model: linear
2017-05-12 09:58:03,059 - __main__ - DEBUG - nbins: 32
2017-05-12 09:58:03,060 - __main__ - DEBUG - regression_users: False
2017-05-12 09:58:03,060 - __main__ - DEBUG - predict_product_features: True
2017-05-12 09:58:03,060 - __main__ - DEBUG - metadata_sources: ['years', 'genres', 'average_rating', 'tvtropes', 'imdb_keywords', 'imdb_producer', 'imdb_director', 'tags']
2017-05-12 09:58:03,060 - __main__ - DEBUG - movies_file: datasets/ml-20m/ml-20m.imdb.medium.csv
2017-05-12 09:58:03,060 - __main__ - DEBUG - cross_validation: 70
2017-05-12 09:58:03,060 - __main__ - DEBUG - tvtropes_file: datasets/dbtropes/tropes.csv
2017-05-12 09:58:03,060 - __main__ - DEBUG - features_trim_percentile: 0
2017-05-12 09:58:03,060 - __main__ - DEBUG - drop_missing_movies: False
2017-05-12 09:58:03,060 - __main__ - DEBUG - drop_rare_features: 500
2017-05-12 09:58:03,060 - __main__ - DEBUG - filter_data_set: 10
2017-05-12 09:58:03,060 - __main__ - DEBUG - persist_dir: /home/maxikov/all_linear_internal_rank_3.state, override_args: False
2017-05-12 09:58:03,060 - __main__ - DEBUG - drop_rare_movies: 50
2017-05-12 09:58:03,060 - __main__ - DEBUG - normalize: True
2017-05-12 09:58:04,276 - __main__ - DEBUG - msep: ,
2017-05-12 09:58:04,276 - __main__ - DEBUG - Loading ratings
2017-05-12 09:58:12,054 - __main__ - DEBUG - Done in 7.777901 seconds
2017-05-12 09:58:12,054 - __main__ - DEBUG - Loading movies
2017-05-12 09:58:13,289 - __main__ - DEBUG - Done in 1.235044 seconds
2017-05-12 09:58:13,290 - __main__ - DEBUG - 26804 movies loaded
2017-05-12 09:59:10,978 - __main__ - DEBUG - 19912669 records in the training set
2017-05-12 09:59:17,405 - __main__ - DEBUG - 26284 unique movies in the training set
2017-05-12 09:59:17,406 - __main__ - DEBUG - Training the average rating model
2017-05-12 09:59:37,648 - __main__ - DEBUG - Done in 20.242247 seconds
2017-05-12 09:59:37,668 - __main__ - DEBUG - Loading /home/maxikov/all_linear_internal_rank_3.state/als_model.pkl
2017-05-12 09:59:40,200 - __main__ - DEBUG - Loading /home/maxikov/all_linear_internal_rank_3.state/indicators.pkl
2017-05-12 10:02:33,147 - __main__ - DEBUG - Normalizing features
2017-05-12 10:02:33,147 - __main__ - DEBUG - Normalizing feature 0
2017-05-12 10:02:33,147 - __main__ - DEBUG - Computing feature ranges
Traceback (most recent call last):
  File "/mnt/encrypted_data/Dropbox/cmu/foundation_of_privacy/project/fop_qii/MovieLensALS.py", line 490, in <module>
    main()
  File "/mnt/encrypted_data/Dropbox/cmu/foundation_of_privacy/project/fop_qii/MovieLensALS.py", line 434, in main
    train_ratio=args.cross_validation)
  File "/mnt/encrypted_data/Dropbox/cmu/foundation_of_privacy/project/fop_qii/internal_feature_predictor.py", line 952, in internal_feature_predictor
    feature_names, logger)
  File "/mnt/encrypted_data/Dropbox/cmu/foundation_of_privacy/project/fop_qii/internal_feature_predictor.py", line 906, in normalize_features
    ranges = common_utils.feature_ranges(cur_feature, logger)
  File "/mnt/encrypted_data/Dropbox/cmu/foundation_of_privacy/project/fop_qii/common_utils.py", line 194, in feature_ranges
    rank = len(features.take(1)[0][1])
TypeError: object of type 'float' has no len()
