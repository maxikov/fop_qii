Sun Jul 2 11:14:09 PDT 2017 spark-submit --driver-memory 10g product_clustering.py --persist-dir new_experiments/product_regression_all_regression_tree_rank_12_depth_5_larger_synth.state/ --user-profiles new_experiments/synth_data_set/profiles.pkl --n-clusters 15 --cluster-model kmeans --movies-file datasets/ml-20m/movies.csv >> new_experiments/logs/product_clustering_larger_synth_kmeans.txt
Loading results dict
Loading indicators
Loading ALS model
Loading movies
Done, 27278 movies loaded
Training kmeans
Done
Centroids: [array([ 0.65296031, -0.06732338,  0.97491478,  0.40163457, -1.00672187,
       -0.88532908, -0.03125366,  0.58979564,  0.96698797,  0.72532818,
       -0.4135738 ,  0.04719839]), array([ 0.2613234 ,  0.96259258,  0.33658281,  0.1370065 , -1.227494  ,
       -0.69993431, -0.51238274,  0.11638625,  0.87357777, -0.0122364 ,
       -0.11481114, -0.51403118]), array([ 0.51374832,  0.62282834,  0.6733976 ,  0.25413513, -0.18414207,
       -0.22286029, -0.69420566, -0.25469724,  1.30261647,  0.25430214,
        0.00142174, -0.12149695]), array([-0.20765531,  0.42047589,  0.16973966,  0.58354139, -0.57384973,
        0.11168667, -0.49675936,  0.03775904,  1.29031832,  1.06546706,
       -0.39140881,  0.02736242]), array([ 0.33316617, -0.01964702,  0.49541872,  0.20275537, -0.51375321,
       -0.43186557, -0.03197863,  0.29092084,  0.50583578,  0.39712349,
       -0.21934936,  0.03085925]), array([ 0.09501734,  0.90531975,  0.43449433,  0.33012   , -1.28681645,
       -0.50449696, -0.7368373 ,  0.02242126,  1.06920384,  0.49390869,
       -0.24446834, -0.38743245]), array([ 0.04852886,  0.20954176,  0.28947563,  0.24540414, -0.33505707,
       -0.26531286, -0.29501805,  0.00506184,  0.4580597 ,  0.19989605,
       -0.00411928, -0.18892901]), array([-0.19010775,  0.30166406,  0.56256428,  1.31422727, -0.22128875,
       -1.10767826, -0.26896598,  0.31807189,  1.03291413,  0.45913952,
        0.33361228, -0.08739072]), array([-0.37780349,  0.43626831,  1.03073861,  0.7009829 , -0.28918334,
       -0.23355904, -0.77859805,  0.14729698,  0.85230787,  0.3833731 ,
       -0.49524845, -0.11843764]), array([ 0.28990836,  0.04711412,  0.58011857,  0.30185057, -0.6456799 ,
       -0.41483264, -0.79964102, -0.13870943,  0.51449212,  1.02468379,
        0.09846684, -1.00895201]), array([-0.2300687 , -0.17635536,  0.87742694,  0.37414616, -1.04136435,
       -0.14760953, -0.68063151, -0.10806507,  0.96854199,  0.53022552,
        0.6870112 , -0.12312974]), array([ 0.06286478, -0.11181478,  0.39503975,  0.83421782, -0.67781654,
       -0.80055589, -0.60582562, -0.430553  ,  0.78282854,  0.18436967,
       -0.53375889, -0.25499517]), array([-0.07295379,  0.22332454,  0.33074856,  0.76411341, -0.75065863,
       -0.27716222, -0.72784972, -0.2133742 ,  1.15789386,  1.05870908,
       -0.45256763, -0.21327122]), array([ -1.15938586e-01,   1.03200143e-03,   5.46824053e-01,
         4.31062771e-01,  -4.87775534e-01,  -1.93246392e-01,
        -3.26004605e-01,   2.49664832e-01,   1.31264357e+00,
         1.80257216e-01,  -1.33170726e-01,  -6.51089837e-01]), array([-0.10880684,  0.22366844,  0.05536696,  0.31259914, -0.32536195,
        0.05510201, -0.25865924,  0.00422662,  0.64565004,  0.60424454,
       -0.20984053,  0.04921482])]
Labeling clusters
Clusters: defaultdict(<type 'int'>, {0.0: 136, 1.0: 204, 2.0: 362, 3.0: 340, 4.0: 164, 5.0: 33, 6.0: 497, 7.0: 118, 8.0: 128, 9.0: 221, 10.0: 160, 11.0: 369, 12.0: 63, 13.0: 807, 14.0: 209})
Centroid mean: [ 0.0636122   0.26524595  0.51685675  0.47918648 -0.63779756 -0.40117696
 -0.48297408  0.04241375  0.91559146  0.50325278 -0.13945366 -0.2343014 ]
Centroid variance: 1.09218513423
Cluster 14 (variance: 0.0454289276387):
	0: (dist: 0.0712709167959) Supervixens (1975) (mid: 26356)
	1: (dist: 0.0712709710879) Extra Man, The (2010) (mid: 82005)
	2: (dist: 0.0712712896941) Buying the Cow (2002) (mid: 33296)
	3: (dist: 0.0712713651096) Risky Business (1983) (mid: 2915)
	4: (dist: 0.0712723530111) House of D (2004) (mid: 33136)
	5: (dist: 0.0712724133394) Starter for 10 (2006) (mid: 51694)
	6: (dist: 0.071272575817) King, The (2005) (mid: 45664)
	7: (dist: 0.0712727253222) Tito and Me (Tito i ja) (1992) (mid: 26793)
	8: (dist: 0.071272804383) Nest, The (Nid de Guêpes) (2002) (mid: 8733)
	9: (dist: 0.0712730455112) Another Day in Paradise (1998) (mid: 2440)
Cluster 4 (variance: 0.0553047440285):
	0: (dist: 0.0956506025483) Need for Speed (2014) (mid: 109850)
	1: (dist: 0.0956521647924) Used Cars (1980) (mid: 5125)
	2: (dist: 0.0956523604436) Heavy (1995) (mid: 764)
	3: (dist: 0.0956524013673) Aberdeen (2000) (mid: 4729)
	4: (dist: 0.0956527440305) Manny & Lo (1996) (mid: 862)
	5: (dist: 0.0956529354263) Close My Eyes (1991) (mid: 56693)
	6: (dist: 0.0956530695409) All Quiet on the Western Front (1930) (mid: 1927)
	7: (dist: 0.0956538839659) Joe and Max (2002) (mid: 56724)
	8: (dist: 0.0956541290286) Polish Wedding (1998) (mid: 2007)
	9: (dist: 0.095654700226) Born American (1986) (mid: 3443)
Cluster 13 (variance: 0.0699414777265):
	0: (dist: 0.0740325384874) Kid for Two Farthings, A (1955) (mid: 112355)
	1: (dist: 0.0740350224244) Arabian Nights (1942) (mid: 64921)
	2: (dist: 0.0740354805078) Bucket Of Blood, A (1959) (mid: 7993)
	3: (dist: 0.074036690227) Return of the Magnificent Seven, The (a.k.a. Return of the Seven) (1966) (mid: 4328)
	4: (dist: 0.0740369968759) Strangeland (1998) (mid: 2298)
	5: (dist: 0.074037717653) President's Man: A Line in the Sand, The (2002) (mid: 96148)
	6: (dist: 0.0740379396458) Day of the Jackal, The (1973) (mid: 8207)
	7: (dist: 0.0740423135371) Naked City, The (1948) (mid: 25943)
	8: (dist: 0.0740425476917) Forgotten, The (2004) (mid: 8870)
	9: (dist: 0.0740425517922) This Means War (2012) (mid: 93326)
Cluster 11 (variance: 0.159830239566):
	0: (dist: 0.0892511484222) Cape Fear (1991) (mid: 1343)
	1: (dist: 0.0892513826132) Big Bird Cage, The (1972) (mid: 5155)
	2: (dist: 0.089251485667) Disgrace (2008) (mid: 77266)
	3: (dist: 0.0892527003267) Pat Garrett and Billy the Kid (1973) (mid: 7889)
	4: (dist: 0.0892539196805) Hamlet 2 (2008) (mid: 61246)
	5: (dist: 0.0892548154872) Enfer, L' (1994) (mid: 264)
	6: (dist: 0.0892551206529) Skin I Live In, The (La piel que habito) (2011) (mid: 89118)
	7: (dist: 0.0892553366599) Circle of Deceit (Die Fälschung) (1981) (mid: 91106)
	8: (dist: 0.0892553744983) Cape Fear (1962) (mid: 1344)
	9: (dist: 0.0892559090906) Spirits of the Dead (1968) (mid: 775)
Cluster 2 (variance: 0.178730481474):
	0: (dist: 0.114266604631) Misfits, The (1961) (mid: 4428)
	1: (dist: 0.114269290897) Home Alone (1990) (mid: 586)
	2: (dist: 0.117341030029) Chitty Chitty Bang Bang (1968) (mid: 7247)
	3: (dist: 0.117345439007) Nashville (1975) (mid: 2303)
	4: (dist: 0.117348028333) Red Dwarf, The (Nain rouge, Le) (1998) (mid: 2685)
	5: (dist: 0.11734816592) Mummy Returns, The (2001) (mid: 4270)
	6: (dist: 0.117348984857) Batman (1989) (mid: 592)
	7: (dist: 0.117350346157) Street Fighter, The (Gekitotsu! Satsujin ken) (1974) (mid: 7892)
	8: (dist: 0.117351926866) Jurassic Park (1993) (mid: 480)
	9: (dist: 0.117352175193) Death Note (2006) (mid: 60609)
Cluster 9 (variance: 0.19314455263):
	0: (dist: 0.122017396981) Royal Affair, A (Kongelig affære, En) (2012) (mid: 96911)
	1: (dist: 0.122017926766) Dandelion (2004) (mid: 39394)
	2: (dist: 0.122018103098) Unmade Beds (1997) (mid: 4208)
	3: (dist: 0.122018238892) Boy Meets Girl (1984) (mid: 26498)
	4: (dist: 0.122019347385) Wilby Wonderful (2004) (mid: 43528)
	5: (dist: 0.12201990346) Unbelievable Truth, The (1989) (mid: 4183)
	6: (dist: 0.122020538301) Role Models (2008) (mid: 63131)
	7: (dist: 0.122020689087) Sliding Doors (1998) (mid: 1680)
	8: (dist: 0.122021194796) Autism: The Musical (2007) (mid: 62390)
	9: (dist: 0.122021260116) Song for Martin, A (Sång för Martin, En) (2001) (mid: 6726)
Cluster 3 (variance: 0.247312773559):
	0: (dist: 0.176829390703) Casino (1995) (mid: 16)
	1: (dist: 0.176829929928) Get Shorty (1995) (mid: 21)
	2: (dist: 0.176838819183) Night of the Creeps (1986) (mid: 3696)
	3: (dist: 0.176843567539) This Is Spinal Tap (1984) (mid: 1288)
	4: (dist: 0.176854172549) Machine Gun Preacher (2011) (mid: 90624)
	5: (dist: 0.1768567371) Deception (2013) (mid: 124857)
	6: (dist: 0.179907750566) Kick-Ass 2 (2013) (mid: 104241)
	7: (dist: 0.179914273288) Hangover Part III, The (2013) (mid: 102686)
	8: (dist: 0.179916998186) Paranormal Activity: The Marked Ones (2014) (mid: 107769)
	9: (dist: 0.179924360078) Hardware (1990) (mid: 34292)
Cluster 1 (variance: 0.257733263999):
	0: (dist: 0.13368705304) Rocky Horror Picture Show, The (1975) (mid: 2657)
	1: (dist: 0.133690365563) Secret Window (2004) (mid: 7347)
	2: (dist: 0.154368632127) Sherlock Holmes: A Game of Shadows (2011) (mid: 91542)
	3: (dist: 0.15436898579) Manchurian Candidate, The (1962) (mid: 1267)
	4: (dist: 0.154370118706) Dead Again (1991) (mid: 3044)
	5: (dist: 0.154373412078) Halloween 4: The Return of Michael Myers (1988) (mid: 1985)
	6: (dist: 0.154374387379) Hamlet (2000) (mid: 3598)
	7: (dist: 0.15437687941) Starsky & Hutch (2004) (mid: 7325)
	8: (dist: 0.154376993765) Friday the 13th Part VIII: Jason Takes Manhattan (1989) (mid: 1981)
	9: (dist: 0.154377469458) Ashes and Diamonds (Popiól i diament) (1958) (mid: 7238)
Cluster 6 (variance: 0.32519719723):
	0: (dist: 0.397049609779) There Was a Crooked Man... (1970) (mid: 73111)
	1: (dist: 0.397060707937) Bad Lieutenant: Port of Call New Orleans (2009) (mid: 72405)
	2: (dist: 0.415671381345) Baarìa (2009) (mid: 78142)
	3: (dist: 0.423664814848) Spy Hard (1996) (mid: 743)
	4: (dist: 0.423667818768) Splendor in the Grass (1961) (mid: 3330)
	5: (dist: 0.42366811171) Informers, The (2008) (mid: 68288)
	6: (dist: 0.423670465333) Desert Heat (Inferno) (1999) (mid: 49979)
	7: (dist: 0.423671899844) Highlander III: The Sorcerer (a.k.a. Highlander: The Final Dimension) (1994) (mid: 405)
	8: (dist: 0.423672343862) Road House (1989) (mid: 4654)
	9: (dist: 0.423673722654) Piano, The (1993) (mid: 509)
Cluster 12 (variance: 0.35443915105):
	0: (dist: 0.312103831714) Vice (2015) (mid: 127323)
	1: (dist: 0.312107375572) Antibodies (Antikörper) (2005) (mid: 48543)
	2: (dist: 0.31212470717) Aftershock (2012) (mid: 102854)
	3: (dist: 0.312126709817) 15 Minutes (2001) (mid: 4167)
	4: (dist: 0.312131442566) Immigrant, The (2013) (mid: 111251)
	5: (dist: 0.31213335645) Lovelace (2013) (mid: 102905)
	6: (dist: 0.312137236518) Vigilante (1983) (mid: 89478)
	7: (dist: 0.324986712426) Watchmen (2009) (mid: 60684)
	8: (dist: 0.324996913689) Evil Dead (2013) (mid: 101739)
	9: (dist: 0.325001659652) Central Park Five, The (2012) (mid: 99468)
Cluster 8 (variance: 0.362116401284):
	0: (dist: 0.201591535399) Abandoned, The (2006) (mid: 51666)
	1: (dist: 0.208083098617) Austin Powers: International Man of Mystery (1997) (mid: 1517)
	2: (dist: 0.208086108325) Rocky III (1982) (mid: 2410)
	3: (dist: 0.208086894547) Monkeybone (2001) (mid: 4158)
	4: (dist: 0.208087306126) Diving Bell and the Butterfly, The (Scaphandre et le papillon, Le) (2007) (mid: 55814)
	5: (dist: 0.208088716014) Rocky IV (1985) (mid: 2411)
	6: (dist: 0.208089209465) Holcroft Covenant, The (1985) (mid: 4983)
	7: (dist: 0.208089839739) Science of Sleep, The (La science des rêves) (2006) (mid: 48082)
	8: (dist: 0.20808998174) Shallow Hal (2001) (mid: 4890)
	9: (dist: 0.208092225786) Rollerball (1975) (mid: 5522)
Cluster 10 (variance: 0.366473993377):
	0: (dist: 0.205793091492) Nativity Story, The (2006) (mid: 49524)
	1: (dist: 0.20830490925) America, America (1963) (mid: 51773)
	2: (dist: 0.208305613141) Lorenzo's Oil (1992) (mid: 7009)
	3: (dist: 0.208307320268) Mighty Heart, A (2007) (mid: 53921)
	4: (dist: 0.208307591026) Mondays in the Sun (Lunes al sol, Los) (2002) (mid: 6571)
	5: (dist: 0.208307908858) Hero (Ying xiong) (2002) (mid: 7090)
	6: (dist: 0.208308239237) Farewell, The (Abschied - Brechts letzter Sommer) (2000) (mid: 5050)
	7: (dist: 0.208308301274) Earth Trembles, The (Terra trema: Episodio del mare, La) (1948) (mid: 5494)
	8: (dist: 0.208308918477) Brassed Off (1996) (mid: 1542)
	9: (dist: 0.208310182175) Secret Garden, The (1993) (mid: 531)
Cluster 0 (variance: 0.399293114148):
	0: (dist: 0.146298857474) Picture of Dorian Gray, The (1945) (mid: 8482)
	1: (dist: 0.146301698053) Bitter Moon (1992) (mid: 347)
	2: (dist: 0.146304725953) Lookout, The (2007) (mid: 52241)
	3: (dist: 0.146305763096) The Chumscrubber (2005) (mid: 34523)
	4: (dist: 0.146305958679) Judgement in Stone, A (Cérémonie, La) (1995) (mid: 1406)
	5: (dist: 0.146307013227) Color of Paradise, The (Rang-e khoda) (1999) (mid: 3456)
	6: (dist: 0.146307686006) Jane Austen Book Club, The (2007) (mid: 55451)
	7: (dist: 0.146308113077) Man of Marble (Czlowiek z Marmuru) (1977) (mid: 6921)
	8: (dist: 0.146308489017) Stranger than Fiction (2006) (mid: 46976)
	9: (dist: 0.146309603315) Youngblood (1986) (mid: 4355)
Cluster 7 (variance: 0.424424050198):
	0: (dist: 0.191170236055) Tree of Wooden Clogs, The (L'albero degli zoccoli) (1978) (mid: 34548)
	1: (dist: 0.191173614939) Day of Wrath (Vredens dag) (1943) (mid: 25898)
	2: (dist: 0.191173790526) Beauty and the Beast (1991) (mid: 595)
	3: (dist: 0.191174613491) Witch Who Came from the Sea, The (1976) (mid: 81574)
	4: (dist: 0.191175713777) Amityville Horror, The (1979) (mid: 1327)
	5: (dist: 0.19117727709) Mexican, The (2001) (mid: 4161)
	6: (dist: 0.191177417165) Milarepa (2006) (mid: 99895)
	7: (dist: 0.191177427116) Maurice (1987) (mid: 3094)
	8: (dist: 0.191178792281) Deluge, The (Potop) (1974) (mid: 8660)
	9: (dist: 0.191178964839) Adam & Steve (2005) (mid: 46194)
Cluster 5 (variance: 0.521389165637):
	0: (dist: 0.411965168717) Drive Angry (2011) (mid: 84942)
	1: (dist: 0.422033536826) Summer of Sam (1999) (mid: 2702)
	2: (dist: 0.422045653377) Kill List (2011) (mid: 89837)
	3: (dist: 0.463656285359) Romeo Is Bleeding (1993) (mid: 521)
	4: (dist: 0.463710155872) Pain & Gain (2013) (mid: 102033)
	5: (dist: 0.463740260956) Primal Fear (1996) (mid: 628)
	6: (dist: 0.467190739854) Looper (2012) (mid: 96610)
	7: (dist: 0.48432269484) Harry Brown (2009) (mid: 74948)
	8: (dist: 0.484348462449) Devil's Rejects, The (2005) (mid: 34323)
	9: (dist: 0.529118076154) Gran Torino (2008) (mid: 64614)
Training a latent tree
DecisionTreeModel classifier of depth 8 with 119 nodes
  If (feature 11 <= -0.6340408325195312)
   If (feature 8 <= 1.139647126197815)
    If (feature 9 <= 0.19809623062610626)
     If (feature 1 <= -0.17234358191490173)
      Predict: 11.0
     Else (feature 1 > -0.17234358191490173)
      Predict: 1.0
    Else (feature 9 > 0.19809623062610626)
     If (feature 4 <= -0.941527783870697)
      If (feature 1 <= -0.08108850568532944)
       If (feature 10 <= -0.06271175295114517)
        If (feature 0 <= -0.4214770495891571)
         Predict: 12.0
        Else (feature 0 > -0.4214770495891571)
         If (feature 0 <= 0.5660356283187866)
          Predict: 9.0
         Else (feature 0 > 0.5660356283187866)
          Predict: 0.0
       Else (feature 10 > -0.06271175295114517)
        Predict: 10.0
      Else (feature 1 > -0.08108850568532944)
       Predict: 5.0
     Else (feature 4 > -0.941527783870697)
      If (feature 3 <= 0.7085521221160889)
       If (feature 2 <= 0.3096158802509308)
        Predict: 3.0
       Else (feature 2 > 0.3096158802509308)
        Predict: 9.0
      Else (feature 3 > 0.7085521221160889)
       Predict: 7.0
   Else (feature 8 > 1.139647126197815)
    If (feature 1 <= 0.4487450122833252)
     If (feature 0 <= 0.26268523931503296)
      Predict: 13.0
     Else (feature 0 > 0.26268523931503296)
      Predict: 11.0
    Else (feature 1 > 0.4487450122833252)
     Predict: 1.0
  Else (feature 11 > -0.6340408325195312)
   If (feature 9 <= 0.7429313659667969)
    If (feature 6 <= -0.46177998185157776)
     If (feature 0 <= 0.2850860059261322)
      If (feature 7 <= -0.1486346274614334)
       If (feature 2 <= 0.6091187000274658)
        If (feature 5 <= -0.39043688774108887)
         Predict: 11.0
        Else (feature 5 > -0.39043688774108887)
         Predict: 12.0
       Else (feature 2 > 0.6091187000274658)
        If (feature 4 <= -0.5204399824142456)
         If (feature 5 <= -0.8697088360786438)
          Predict: 1.0
         Else (feature 5 > -0.8697088360786438)
          Predict: 10.0
        Else (feature 4 > -0.5204399824142456)
         If (feature 3 <= 0.26534104347229004)
          Predict: 2.0
         Else (feature 3 > 0.26534104347229004)
          Predict: 8.0
      Else (feature 7 > -0.1486346274614334)
       If (feature 1 <= -0.11400430649518967)
        Predict: 10.0
       Else (feature 1 > -0.11400430649518967)
        If (feature 0 <= 0.15205618739128113)
         If (feature 10 <= -0.158072367310524)
          Predict: 8.0
         Else (feature 10 > -0.158072367310524)
          Predict: 7.0
        Else (feature 0 > 0.15205618739128113)
         If (feature 5 <= -0.5838766098022461)
          Predict: 1.0
         Else (feature 5 > -0.5838766098022461)
          Predict: 2.0
     Else (feature 0 > 0.2850860059261322)
      If (feature 4 <= -0.6997012495994568)
       If (feature 1 <= 0.1463172733783722)
        Predict: 10.0
       Else (feature 1 > 0.1463172733783722)
        If (feature 9 <= 0.14734670519828796)
         Predict: 1.0
        Else (feature 9 > 0.14734670519828796)
         Predict: 5.0
      Else (feature 4 > -0.6997012495994568)
       If (feature 2 <= 0.9389520883560181)
        Predict: 2.0
       Else (feature 2 > 0.9389520883560181)
        Predict: 8.0
    Else (feature 6 > -0.46177998185157776)
     If (feature 5 <= -0.018589656800031662)
      If (feature 7 <= 0.12993140518665314)
       If (feature 5 <= -0.48955145478248596)
        If (feature 1 <= 0.25387516617774963)
         If (feature 1 <= 0.013212568126618862)
          Predict: 11.0
         Else (feature 1 > 0.013212568126618862)
          Predict: 7.0
        Else (feature 1 > 0.25387516617774963)
         Predict: 1.0
       Else (feature 5 > -0.48955145478248596)
        If (feature 8 <= 0.7437856793403625)
         If (feature 9 <= 0.5718545317649841)
          Predict: 6.0
         Else (feature 9 > 0.5718545317649841)
          Predict: 14.0
        Else (feature 8 > 0.7437856793403625)
         If (feature 0 <= -0.08713676035404205)
          Predict: 10.0
         Else (feature 0 > -0.08713676035404205)
          Predict: 2.0
      Else (feature 7 > 0.12993140518665314)
       If (feature 8 <= 0.7106781601905823)
        If (feature 0 <= 0.15205618739128113)
         If (feature 5 <= -0.8697088360786438)
          Predict: 7.0
         Else (feature 5 > -0.8697088360786438)
          Predict: 6.0
        Else (feature 0 > 0.15205618739128113)
         If (feature 4 <= -1.0890015363693237)
          Predict: 1.0
         Else (feature 4 > -1.0890015363693237)
          Predict: 4.0
       Else (feature 8 > 0.7106781601905823)
        If (feature 0 <= 0.3041074872016907)
         If (feature 3 <= 0.5376117825508118)
          Predict: 13.0
         Else (feature 3 > 0.5376117825508118)
          Predict: 7.0
        Else (feature 0 > 0.3041074872016907)
         Predict: 0.0
     Else (feature 5 > -0.018589656800031662)
      If (feature 7 <= 0.050516411662101746)
       Predict: 14.0
      Else (feature 7 > 0.050516411662101746)
       If (feature 0 <= -0.31136608123779297)
        Predict: 3.0
       Else (feature 0 > -0.31136608123779297)
        If (feature 0 <= -0.23402594029903412)
         Predict: 13.0
        Else (feature 0 > -0.23402594029903412)
         Predict: 2.0
   Else (feature 9 > 0.7429313659667969)
    If (feature 5 <= -0.15555675327777863)
     If (feature 7 <= -0.07005010545253754)
      If (feature 2 <= 0.6655256748199463)
       Predict: 12.0
      Else (feature 2 > 0.6655256748199463)
       Predict: 10.0
     Else (feature 7 > -0.07005010545253754)
      If (feature 3 <= 0.6181935667991638)
       If (feature 0 <= -0.4214770495891571)
        Predict: 5.0
       Else (feature 0 > -0.4214770495891571)
        If (feature 4 <= -0.65147465467453)
         Predict: 0.0
        Else (feature 4 > -0.65147465467453)
         Predict: 9.0
      Else (feature 3 > 0.6181935667991638)
       Predict: 7.0
    Else (feature 5 > -0.15555675327777863)
     If (feature 8 <= 0.9963283538818359)
      If (feature 0 <= -0.23402594029903412)
       If (feature 2 <= 0.03737645968794823)
        Predict: 3.0
       Else (feature 2 > 0.03737645968794823)
        Predict: 10.0
      Else (feature 0 > -0.23402594029903412)
       If (feature 0 <= 0.026565156877040863)
        Predict: 14.0
       Else (feature 0 > 0.026565156877040863)
        Predict: 12.0
     Else (feature 8 > 0.9963283538818359)
      If (feature 10 <= 0.021185368299484253)
       Predict: 3.0
      Else (feature 10 > 0.021185368299484253)
       If (feature 2 <= 0.03737645968794823)
        Predict: 3.0
       Else (feature 2 > 0.03737645968794823)
        Predict: 10.0

Done, making predictions
Accuracy of latent tree on training set: 0.981419546637
Accuracy of latent tree on test set: 0.96875
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 147 nodes
  If (average_rating <= 2.0)
   If (Isn't imdb_keywords:truck)
    If (Isn't imdb_keywords:bathroom)
     Predict: 6.0
    Else (Is imdb_keywords:bathroom)
     If (Isn't imdb_keywords:severed-head)
      If (Isn't imdb_keywords:texas)
       Predict: 14.0
      Else (Is imdb_keywords:texas)
       Predict: 6.0
     Else (Is imdb_keywords:severed-head)
      Predict: 6.0
   Else (Is imdb_keywords:truck)
    Predict: 4.0
  Else (average_rating > 2.0)
   If (Isn't imdb_keywords:chase)
    If (Isn't tvtropes:oh crap)
     If (Isn't imdb_keywords:rape)
      If (Isn't imdb_keywords:depression)
       If (Isn't imdb_keywords:f-word)
        If (Isn't movielens_tags:murder)
         If (Isn't imdb_keywords:accident)
          Predict: 10.0
         Else (Is imdb_keywords:accident)
          Predict: 0.0
        Else (Is movielens_tags:murder)
         If (Isn't imdb_keywords:accident)
          Predict: 1.0
         Else (Is imdb_keywords:accident)
          Predict: 0.0
       Else (Is imdb_keywords:f-word)
        If (Isn't imdb_keywords:bathroom)
         If (Isn't imdb_keywords:hope)
          Predict: 3.0
         Else (Is imdb_keywords:hope)
          Predict: 10.0
        Else (Is imdb_keywords:bathroom)
         If (Isn't movielens_tags:DVD-RAM)
          Predict: 14.0
         Else (Is movielens_tags:DVD-RAM)
          Predict: 0.0
      Else (Is imdb_keywords:depression)
       If (Isn't imdb_keywords:f-word)
        If (Isn't imdb_keywords:hope)
         If (Isn't imdb_keywords:accident)
          Predict: 9.0
         Else (Is imdb_keywords:accident)
          Predict: 0.0
        Else (Is imdb_keywords:hope)
         If (Isn't imdb_keywords:ambulance)
          Predict: 10.0
         Else (Is imdb_keywords:ambulance)
          Predict: 5.0
       Else (Is imdb_keywords:f-word)
        If (Isn't imdb_keywords:bathroom)
         If (Isn't movielens_tags:cinematography)
          Predict: 12.0
         Else (Is movielens_tags:cinematography)
          Predict: 0.0
        Else (Is imdb_keywords:bathroom)
         Predict: 9.0
     Else (Is imdb_keywords:rape)
      If (Isn't imdb_keywords:f-word)
       If (Isn't imdb_keywords:depression)
        If (Isn't imdb_keywords:curse)
         If (Isn't imdb_keywords:reverse-footage)
          Predict: 11.0
         Else (Is imdb_keywords:reverse-footage)
          Predict: 8.0
        Else (Is imdb_keywords:curse)
         If (Isn't movielens_tags:Bibliothek)
          Predict: 7.0
         Else (Is movielens_tags:Bibliothek)
          Predict: 0.0
       Else (Is imdb_keywords:depression)
        If (Isn't imdb_keywords:doll)
         Predict: 9.0
        Else (Is imdb_keywords:doll)
         If (year <= 1998.0)
          Predict: 11.0
         Else (year > 1998.0)
          Predict: 1.0
      Else (Is imdb_keywords:f-word)
       If (Isn't imdb_keywords:bathroom)
        If (Isn't movielens_genre:War)
         Predict: 12.0
        Else (Is movielens_genre:War)
         Predict: 3.0
       Else (Is imdb_keywords:bathroom)
        If (year <= 2008.0)
         Predict: 5.0
        Else (year > 2008.0)
         Predict: 11.0
    Else (Is tvtropes:oh crap)
     If (Isn't movielens_tags:murder)
      If (Isn't imdb_keywords:f-word)
       If (Isn't imdb_keywords:reverse-footage)
        If (Isn't imdb_keywords:depression)
         If (Isn't imdb_keywords:curse)
          Predict: 2.0
         Else (Is imdb_keywords:curse)
          Predict: 7.0
        Else (Is imdb_keywords:depression)
         Predict: 9.0
       Else (Is imdb_keywords:reverse-footage)
        If (Isn't imdb_keywords:book)
         Predict: 8.0
        Else (Is imdb_keywords:book)
         If (year <= 1987.0)
          Predict: 10.0
         Else (year > 1987.0)
          Predict: 2.0
      Else (Is imdb_keywords:f-word)
       If (Isn't imdb_keywords:rape)
        If (Isn't imdb_keywords:ambush)
         Predict: 3.0
        Else (Is imdb_keywords:ambush)
         Predict: 2.0
       Else (Is imdb_keywords:rape)
        If (Isn't movielens_tags:DVD-Video)
         Predict: 12.0
        Else (Is movielens_tags:DVD-Video)
         Predict: 2.0
     Else (Is movielens_tags:murder)
      If (Isn't imdb_keywords:blood-splatter)
       Predict: 1.0
      Else (Is imdb_keywords:blood-splatter)
       Predict: 5.0
   Else (Is imdb_keywords:chase)
    If (Isn't imdb_keywords:f-word)
     If (Isn't movielens_tags:murder)
      If (Isn't tvtropes:oh crap)
       If (Isn't imdb_keywords:rape)
        If (Isn't imdb_keywords:depression)
         If (Isn't imdb_keywords:reverse-footage)
          Predict: 13.0
         Else (Is imdb_keywords:reverse-footage)
          Predict: 8.0
        Else (Is imdb_keywords:depression)
         If (Isn't imdb_keywords:accident)
          Predict: 9.0
         Else (Is imdb_keywords:accident)
          Predict: 0.0
       Else (Is imdb_keywords:rape)
        If (Isn't imdb_keywords:reverse-footage)
         If (Isn't imdb_keywords:curse)
          Predict: 11.0
         Else (Is imdb_keywords:curse)
          Predict: 7.0
        Else (Is imdb_keywords:reverse-footage)
         Predict: 8.0
      Else (Is tvtropes:oh crap)
       If (Isn't imdb_keywords:reverse-footage)
        If (Isn't imdb_keywords:snake)
         If (Isn't imdb_keywords:waitress)
          Predict: 2.0
         Else (Is imdb_keywords:waitress)
          Predict: 10.0
        Else (Is imdb_keywords:snake)
         If (Isn't movielens_genre:Sci-Fi)
          Predict: 13.0
         Else (Is movielens_genre:Sci-Fi)
          Predict: 11.0
       Else (Is imdb_keywords:reverse-footage)
        If (Isn't movielens_genre:Fantasy)
         Predict: 8.0
        Else (Is movielens_genre:Fantasy)
         Predict: 7.0
     Else (Is movielens_tags:murder)
      If (Isn't imdb_keywords:accident)
       If (Isn't movielens_tags:religion)
        If (Isn't imdb_keywords:reverse-footage)
         If (Isn't imdb_keywords:high-school)
          Predict: 1.0
         Else (Is imdb_keywords:high-school)
          Predict: 13.0
        Else (Is imdb_keywords:reverse-footage)
         If (Isn't imdb_keywords:evil-man)
          Predict: 5.0
         Else (Is imdb_keywords:evil-man)
          Predict: 1.0
       Else (Is movielens_tags:religion)
        Predict: 11.0
      Else (Is imdb_keywords:accident)
       Predict: 0.0
    Else (Is imdb_keywords:f-word)
     If (Isn't imdb_keywords:rape)
      If (Isn't imdb_keywords:bathroom)
       If (Isn't imdb_keywords:curse)
        If (Isn't imdb_keywords:accident)
         If (Isn't movielens_tags:murder)
          Predict: 3.0
         Else (Is movielens_tags:murder)
          Predict: 5.0
        Else (Is imdb_keywords:accident)
         Predict: 0.0
       Else (Is imdb_keywords:curse)
        Predict: 7.0
      Else (Is imdb_keywords:bathroom)
       If (Isn't movielens_tags:based on a book)
        If (Isn't movielens_tags:funny)
         Predict: 13.0
        Else (Is movielens_tags:funny)
         Predict: 2.0
       Else (Is movielens_tags:based on a book)
        If (year <= 1996.0)
         Predict: 9.0
        Else (year > 1996.0)
         Predict: 0.0
     Else (Is imdb_keywords:rape)
      If (Isn't imdb_keywords:death-of-mother)
       If (average_rating <= 3.2829259048701913)
        If (year <= 1980.0)
         Predict: 3.0
        Else (year > 1980.0)
         Predict: 11.0
       Else (average_rating > 3.2829259048701913)
        Predict: 12.0
      Else (Is imdb_keywords:death-of-mother)
       Predict: 5.0

Done, making predictions
Accuracy of meta tree on training set: 0.933382679497
Accuracy of meta tree on test set: 0.891794409378
36 features used
15 clusters found
Processing cluster 0.0
QIIs: [('movielens_genre:Fantasy', 0.29411764705882354), ('imdb_keywords:ambulance', 0.13970588235294118), ('movielens_tags:religion', 0.10294117647058823), ('imdb_keywords:reverse-footage', 0.07352941176470588), ('imdb_keywords:curse', 0.058823529411764705), ('movielens_tags:Bibliothek', 0.03676470588235294), ('imdb_keywords:death-of-mother', 0.022058823529411766), ('imdb_keywords:book', 0.014705882352941176), ('imdb_keywords:f-word', 0.007352941176470588), ('movielens_tags:cinematography', 0.007352941176470588), ('movielens_tags:funny', 0.007352941176470588), ('movielens_tags:murder', 0.007352941176470588), ('imdb_keywords:blood-splatter', 0.007352941176470588), ('imdb_keywords:ambush', 0.007352941176470588)]
Correctness scores: [(8, 0.1694915254237288), (1, 0.13559322033898305), (0, 0.01694915254237288), (5, 0.01694915254237288), (2, 0.0), (3, 0.0), (4, 0.0), (6, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 1.0
QIIs: [('imdb_keywords:ambulance', 0.08333333333333333), ('movielens_genre:Fantasy', 0.058823529411764705), ('movielens_tags:Bibliothek', 0.04411764705882353), ('movielens_tags:based on a book', 0.029411764705882353), ('imdb_keywords:doll', 0.024509803921568627), ('imdb_keywords:reverse-footage', 0.0196078431372549), ('imdb_keywords:evil-man', 0.00980392156862745), ('imdb_keywords:rape', 0.004901960784313725), ('imdb_keywords:book', 0.004901960784313725), ('imdb_keywords:truck', 0.004901960784313725)]
Correctness scores: [(3, 0.1724137931034483), (8, 0.13793103448275862), (2, 0.034482758620689655), (7, 0.034482758620689655), (0, 0.0), (1, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (9, 0.0)]
Processing cluster 2.0
QIIs: [('imdb_keywords:accident', 0.024861878453038673), ('movielens_genre:Fantasy', 0.019337016574585635), ('movielens_tags:religion', 0.013812154696132596), ('imdb_keywords:death-of-mother', 0.0055248618784530384), ('year', 0.0027624309392265192), ('imdb_keywords:chase', 0.0027624309392265192), ('movielens_genre:Sci-Fi', 0.0027624309392265192), ('imdb_keywords:high-school', 0.0027624309392265192), ('imdb_keywords:f-word', 0.0027624309392265192), ('average_rating', 0.0027624309392265192), ('imdb_keywords:blood-splatter', 0.0027624309392265192), ('imdb_keywords:book', 0.0027624309392265192), ('imdb_keywords:bathroom', 0.0027624309392265192), ('imdb_keywords:ambulance', 0.0027624309392265192)]
Correctness scores: [(2, 0.5625), (0, 0.125), (4, 0.0625), (1, 0.0), (3, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 3.0
QIIs: [('movielens_genre:Fantasy', 0.026470588235294117), ('imdb_keywords:curse', 0.014705882352941176), ('average_rating', 0.011764705882352941), ('movielens_tags:Bibliothek', 0.008823529411764706), ('imdb_keywords:reverse-footage', 0.008823529411764706), ('movielens_tags:funny', 0.008823529411764706), ('imdb_keywords:ambulance', 0.0058823529411764705), ('year', 0.0029411764705882353), ('movielens_tags:DVD-Video', 0.0029411764705882353), ('imdb_keywords:depression', 0.0029411764705882353)]
Correctness scores: [(1, 0.35714285714285715), (8, 0.21428571428571427), (3, 0.07142857142857142), (0, 0.0), (2, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 4.0
QIIs: [('imdb_keywords:depression', 0.08536585365853659), ('imdb_keywords:snake', 0.042682926829268296)]
Correctness scores: [(3, 0.6666666666666667), (9, 0.33333333333333337), (0, 0.0), (1, 0.0), (2, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0)]
Processing cluster 5.0
QIIs: [('movielens_tags:religion', 0.3333333333333333), ('movielens_genre:Fantasy', 0.21212121212121213), ('imdb_keywords:reverse-footage', 0.18181818181818182), ('imdb_keywords:book', 0.12121212121212122), ('imdb_keywords:rape', 0.09090909090909091), ('movielens_tags:Bibliothek', 0.06060606060606061), ('movielens_tags:funny', 0.06060606060606061), ('imdb_keywords:doll', 0.06060606060606061), ('imdb_keywords:texas', 0.06060606060606061), ('tvtropes:oh crap', 0.030303030303030304), ('imdb_keywords:ambulance', 0.030303030303030304)]
Correctness scores: [(8, 0.33333333333333337), (7, 0.16666666666666669), (3, 0.11111111111111112), (9, 0.05555555555555556), (0, 0.0), (1, 0.0), (2, 0.0), (4, 0.0), (5, 0.0), (6, 0.0)]
Processing cluster 6.0
QIIs: [('imdb_keywords:blood-splatter', 0.01609657947686117), ('imdb_keywords:severed-head', 0.014084507042253521), ('imdb_keywords:hope', 0.002012072434607646)]
Correctness scores: [(5, 0.4666666666666666), (6, 0.06666666666666667), (0, 0.0), (1, 0.0), (2, 0.0), (3, 0.0), (4, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 7.0
QIIs: [('movielens_genre:Fantasy', 0.3389830508474576), ('imdb_keywords:ambulance', 0.2542372881355932), ('movielens_tags:religion', 0.11864406779661017), ('movielens_tags:Bibliothek', 0.11016949152542373), ('imdb_keywords:book', 0.0847457627118644), ('imdb_keywords:reverse-footage', 0.06779661016949153), ('imdb_keywords:curse', 0.03389830508474576), ('movielens_tags:cinematography', 0.01694915254237288), ('movielens_tags:funny', 0.01694915254237288), ('movielens_genre:War', 0.00847457627118644)]
Correctness scores: [(8, 0.1142857142857143), (1, 0.05714285714285715), (0, 0.0), (2, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 8.0
QIIs: [('movielens_genre:Fantasy', 0.375), ('movielens_tags:Bibliothek', 0.1796875), ('imdb_keywords:ambulance', 0.09375), ('movielens_genre:War', 0.015625), ('imdb_keywords:high-school', 0.015625), ('movielens_tags:religion', 0.015625), ('imdb_keywords:curse', 0.0078125), ('imdb_keywords:blood-splatter', 0.0078125)]
Correctness scores: [(1, 0.014084507042253521), (0, 0.0), (2, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 9.0
QIIs: [('movielens_tags:religion', 0.04072398190045249), ('movielens_genre:Fantasy', 0.03619909502262444), ('imdb_keywords:blood-splatter', 0.03167420814479638), ('imdb_keywords:ambulance', 0.02262443438914027), ('movielens_tags:Bibliothek', 0.013574660633484163), ('movielens_tags:funny', 0.013574660633484163), ('tvtropes:oh crap', 0.004524886877828055), ('imdb_keywords:f-word', 0.004524886877828055), ('imdb_keywords:accident', 0.004524886877828055), ('imdb_keywords:truck', 0.004524886877828055)]
Correctness scores: [(2, 0.11764705882352941), (0, 0.058823529411764705), (9, 0.058823529411764705), (1, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0)]
Processing cluster 10.0
QIIs: [('movielens_genre:Fantasy', 0.39375), ('movielens_tags:Bibliothek', 0.1375), ('imdb_keywords:ambulance', 0.08125), ('movielens_tags:religion', 0.06875), ('imdb_keywords:reverse-footage', 0.04375), ('imdb_keywords:book', 0.04375), ('imdb_keywords:accident', 0.0125), ('year', 0.00625), ('tvtropes:oh crap', 0.00625), ('imdb_keywords:blood-splatter', 0.00625), ('imdb_keywords:death-of-mother', 0.00625)]
Correctness scores: [(8, 0.08235294117647059), (2, 0.023529411764705882), (9, 0.011764705882352941), (0, 0.0), (1, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0)]
Processing cluster 11.0
QIIs: [('movielens_tags:religion', 0.02168021680216802), ('year', 0.013550135501355014), ('movielens_genre:Fantasy', 0.013550135501355014), ('imdb_keywords:blood-splatter', 0.013550135501355014), ('movielens_tags:Bibliothek', 0.01084010840108401), ('imdb_keywords:curse', 0.008130081300813009), ('imdb_keywords:evil-man', 0.008130081300813009), ('movielens_genre:Sci-Fi', 0.0027100271002710027), ('imdb_keywords:reverse-footage', 0.0027100271002710027), ('movielens_tags:DVD-RAM', 0.0027100271002710027), ('imdb_keywords:truck', 0.0027100271002710027)]
Correctness scores: [(1, 0.2307692307692308), (2, 0.07692307692307693), (8, 0.07692307692307693), (0, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 12.0
QIIs: [('imdb_keywords:reverse-footage', 0.20634920634920634), ('imdb_keywords:ambulance', 0.20634920634920634), ('movielens_genre:Fantasy', 0.12698412698412698), ('movielens_tags:Bibliothek', 0.031746031746031744), ('movielens_tags:murder', 0.015873015873015872), ('imdb_keywords:curse', 0.015873015873015872), ('imdb_keywords:texas', 0.015873015873015872)]
Correctness scores: [(8, 0.5), (1, 0.038461538461538464), (5, 0.038461538461538464), (0, 0.0), (2, 0.0), (3, 0.0), (4, 0.0), (6, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 13.0
QIIs: [('movielens_tags:religion', 0.013630731102850062), ('imdb_keywords:blood-splatter', 0.009913258983890954), ('imdb_keywords:curse', 0.008674101610904586), ('movielens_genre:Sci-Fi', 0.006195786864931847), ('movielens_tags:Bibliothek', 0.004956629491945477), ('imdb_keywords:book', 0.004956629491945477), ('imdb_keywords:ambulance', 0.004956629491945477), ('movielens_tags:DVD-RAM', 0.0037174721189591076), ('imdb_keywords:f-word', 0.0024783147459727386), ('movielens_tags:based on a book', 0.0024783147459727386), ('year', 0.0012391573729863693)]
Correctness scores: [(1, 0.3684210526315789), (0, 0.10526315789473684), (2, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 14.0
QIIs: [('imdb_keywords:depression', 0.1339712918660287), ('movielens_tags:religion', 0.11004784688995216), ('imdb_keywords:hope', 0.014354066985645933), ('imdb_keywords:waitress', 0.009569377990430622), ('imdb_keywords:ambush', 0.009569377990430622), ('imdb_keywords:severed-head', 0.004784688995215311)]
Correctness scores: [(3, 0.5490196078431373), (6, 0.058823529411764705), (5, 0.0196078431372549), (0, 0.0), (1, 0.0), (2, 0.0), (4, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
All highers corrs: [0.1694915254237288, 0.1724137931034483, 0.5625, 0.35714285714285715, 0.6666666666666667, 0.33333333333333337, 0.4666666666666666, 0.1142857142857143, 0.014084507042253521, 0.11764705882352941, 0.08235294117647059, 0.2307692307692308, 0.5, 0.3684210526315789, 0.5490196078431373]
Their profiles: [8, 3, 2, 1, 3, 8, 5, 8, 1, 2, 8, 1, 8, 1, 3]
5 profiles represented
Average: 0.313652996994
Results: {8: {'cluster': 12.0, 'corr': 0.5}, 1: {'cluster': 13.0, 'corr': 0.3684210526315789}, 2: {'cluster': 2.0, 'corr': 0.5625}, 3: {'cluster': 4.0, 'corr': 0.6666666666666667}, 5: {'cluster': 6.0, 'corr': 0.4666666666666666}}
Average corr: 0.512850877193
Making per-cluster trees
Processing cluster 0.0
New clusters: defaultdict(<type 'int'>, {0.0: 3675, 1.0: 136})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 2 with 5 nodes
  If (Isn't imdb_keywords:accident)
   Predict: 0.0
  Else (Is imdb_keywords:accident)
   If (Is imdb_keywords:truck)
    Predict: 0.0
   Else (Isn't imdb_keywords:truck)
    Predict: 1.0

Done, making predictions
Accuracy of cluster 0.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 0.0 meta tree on test set: 1.0
{'recall': 1.0, 'precision': 1.0}
2 features used
QIIs: [('imdb_keywords:truck', 0.06796116504854369), ('imdb_keywords:accident', 0.005772763054316453)]
Correctness scores: [(2, 1.0), (0, 0.0), (1, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 1.0
New clusters: defaultdict(<type 'int'>, {0.0: 3607, 1.0: 204})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 25 nodes
  If (Isn't movielens_tags:murder)
   Predict: 0.0
  Else (Is movielens_tags:murder)
   If (Is imdb_keywords:f-word)
    Predict: 0.0
   Else (Isn't imdb_keywords:f-word)
    If (Is imdb_keywords:accident)
     Predict: 0.0
    Else (Isn't imdb_keywords:accident)
     If (Is imdb_keywords:reverse-footage)
      If (Isn't movielens_genre:Sci-Fi)
       Predict: 0.0
      Else (Is movielens_genre:Sci-Fi)
       Predict: 1.0
     Else (Isn't imdb_keywords:reverse-footage)
      If (Is imdb_keywords:severed-head)
       If (Is movielens_genre:Drama)
        Predict: 0.0
       Else (Isn't movielens_genre:Drama)
        If (Is movielens_genre:Mystery)
         Predict: 0.0
        Else (Isn't movielens_genre:Mystery)
         Predict: 1.0
      Else (Isn't imdb_keywords:severed-head)
       If (Is imdb_keywords:hope)
        If (year <= 2003.0)
         Predict: 0.0
        Else (year > 2003.0)
         Predict: 1.0
       Else (Isn't imdb_keywords:hope)
        If (Is imdb_keywords:debt)
         If (Isn't imdb_keywords:blackmail)
          Predict: 0.0
         Else (Is imdb_keywords:blackmail)
          Predict: 1.0
        Else (Isn't imdb_keywords:debt)
         Predict: 1.0

Done, making predictions
Accuracy of cluster 1.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 1.0 meta tree on test set: 0.99063032368
{'recall': 0.9833333333333333, 'precision': 0.855072463768116}
12 features used
QIIs: [('movielens_genre:Drama', 0.09472579375491996), ('imdb_keywords:severed-head', 0.012595119391235896), ('imdb_keywords:reverse-footage', 0.005510364733665705), ('movielens_genre:Mystery', 0.004985568092364209), ('movielens_tags:murder', 0.004198373130411965), ('imdb_keywords:accident', 0.003411178168459722), ('imdb_keywords:hope', 0.003411178168459722), ('year', 0.0010495932826029913), ('imdb_keywords:blackmail', 0.0007871949619522435), ('movielens_genre:Sci-Fi', 0.0007871949619522435), ('imdb_keywords:f-word', 0.0007871949619522435), ('imdb_keywords:debt', 0.0002623983206507478)]
Correctness scores: [(5, 0.15647921760391198), (8, 0.051344743276283626), (2, 0.03178484107579462), (6, 0.03178484107579462), (0, 0.007334963325183375), (1, 0.0), (3, 0.0), (4, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 2.0
New clusters: defaultdict(<type 'int'>, {0.0: 3449, 1.0: 362})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 21 nodes
  If (Isn't tvtropes:oh crap)
   Predict: 0.0
  Else (Is tvtropes:oh crap)
   If (Is movielens_tags:murder)
    Predict: 0.0
   Else (Isn't movielens_tags:murder)
    If (Is imdb_keywords:f-word)
     If (Isn't imdb_keywords:bathroom)
      Predict: 0.0
     Else (Is imdb_keywords:bathroom)
      Predict: 1.0
    Else (Isn't imdb_keywords:f-word)
     If (Is imdb_keywords:reverse-footage)
      If (Isn't movielens_genre:Western)
       Predict: 0.0
      Else (Is movielens_genre:Western)
       Predict: 1.0
     Else (Isn't imdb_keywords:reverse-footage)
      If (Is imdb_keywords:hope)
       Predict: 0.0
      Else (Isn't imdb_keywords:hope)
       If (Is imdb_keywords:depression)
        Predict: 0.0
       Else (Isn't imdb_keywords:depression)
        If (Is imdb_keywords:curse)
         Predict: 0.0
        Else (Isn't imdb_keywords:curse)
         If (Is imdb_keywords:snake)
          Predict: 0.0
         Else (Isn't imdb_keywords:snake)
          Predict: 1.0

Done, making predictions
Accuracy of cluster 2.0 meta tree on training set: 0.997358490566
{'recall': 0.9754098360655737, 'precision': 0.99581589958159}
Accuracy of cluster 2.0 meta tree on test set: 0.993109388458
{'recall': 0.9491525423728814, 'precision': 0.9824561403508771}
10 features used
QIIs: [('imdb_keywords:depression', 0.14956704277092628), ('tvtropes:oh crap', 0.02204145893466282), ('movielens_genre:Western', 0.01338231435318814), ('imdb_keywords:f-word', 0.010495932826029914), ('imdb_keywords:bathroom', 0.008921542902125426), ('imdb_keywords:snake', 0.00839674626082393), ('imdb_keywords:curse', 0.006559958016268696), ('movielens_tags:murder', 0.004723169771713461), ('imdb_keywords:hope', 0.0018367882445552348), ('imdb_keywords:reverse-footage', 0.0005247966413014956)]
Correctness scores: [(3, 0.8715596330275228), (9, 0.17737003058103973), (0, 0.11314984709480119), (1, 0.03822629969418959), (5, 0.02752293577981651), (6, 0.010703363914373086), (8, 0.0030581039755351674), (2, 0.0), (4, 0.0), (7, 0.0)]
Processing cluster 3.0
New clusters: defaultdict(<type 'int'>, {0.0: 3471, 1.0: 340})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 27 nodes
  If (Isn't imdb_keywords:f-word)
   Predict: 0.0
  Else (Is imdb_keywords:f-word)
   If (Is imdb_keywords:bathroom)
    Predict: 0.0
   Else (Isn't imdb_keywords:bathroom)
    If (Is imdb_keywords:rape)
     If (Isn't movielens_genre:War)
      Predict: 0.0
     Else (Is movielens_genre:War)
      Predict: 1.0
    Else (Isn't imdb_keywords:rape)
     If (Is imdb_keywords:depression)
      If (Isn't imdb_keywords:1960s)
       Predict: 0.0
      Else (Is imdb_keywords:1960s)
       Predict: 1.0
     Else (Isn't imdb_keywords:depression)
      If (Is imdb_keywords:hope)
       If (Isn't movielens_genre:Comedy)
        Predict: 0.0
       Else (Is movielens_genre:Comedy)
        Predict: 1.0
      Else (Isn't imdb_keywords:hope)
       If (Is movielens_tags:murder)
        If (Isn't imdb_keywords:severed-head)
         Predict: 0.0
        Else (Is imdb_keywords:severed-head)
         If (Is movielens_genre:Action)
          Predict: 0.0
         Else (Isn't movielens_genre:Action)
          Predict: 1.0
       Else (Isn't movielens_tags:murder)
        If (Is imdb_keywords:accident)
         Predict: 0.0
        Else (Isn't imdb_keywords:accident)
         If (Is imdb_keywords:curse)
          Predict: 0.0
         Else (Isn't imdb_keywords:curse)
          Predict: 1.0

Done, making predictions
Accuracy of cluster 3.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 3.0 meta tree on test set: 0.997316636852
{'recall': 0.9894736842105263, 'precision': 0.9791666666666666}
13 features used
QIIs: [('imdb_keywords:accident', 0.14536866964051431), ('imdb_keywords:curse', 0.021254263972710574), ('imdb_keywords:severed-head', 0.019942272369456837), ('imdb_keywords:rape', 0.008134347940173182), ('movielens_genre:Comedy', 0.007871949619522435), ('imdb_keywords:hope', 0.0060351613749672), ('imdb_keywords:f-word', 0.004723169771713461), ('imdb_keywords:bathroom', 0.004198373130411965), ('movielens_tags:murder', 0.0020991865652059826), ('movielens_genre:Action', 0.001574389923904487), ('imdb_keywords:depression', 0.001574389923904487), ('movielens_genre:War', 0.0007871949619522435), ('imdb_keywords:1960s', 0.0005247966413014956)]
Correctness scores: [(2, 0.8724409448818897), (5, 0.13228346456692913), (1, 0.12755905511811022), (0, 0.053543307086614166), (7, 0.04881889763779527), (6, 0.03622047244094488), (3, 0.009448818897637795), (4, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 4.0
New clusters: defaultdict(<type 'int'>, {0.0: 3647, 1.0: 164})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 5 with 11 nodes
  If (Isn't imdb_keywords:truck)
   Predict: 0.0
  Else (Is imdb_keywords:truck)
   If (average_rating <= 2.0)
    Predict: 1.0
   Else (average_rating > 2.0)
    If (Isn't imdb_keywords:accident)
     Predict: 0.0
    Else (Is imdb_keywords:accident)
     If (Is imdb_keywords:crying)
      If (Isn't movielens_tags:DVD-RAM)
       Predict: 0.0
      Else (Is movielens_tags:DVD-RAM)
       Predict: 1.0
     Else (Isn't imdb_keywords:crying)
      Predict: 1.0

Done, making predictions
Accuracy of cluster 4.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 4.0 meta tree on test set: 0.998251748252
{'recall': 0.9761904761904762, 'precision': 0.9761904761904762}
5 features used
QIIs: [('imdb_keywords:crying', 0.062450800314877986), ('average_rating', 0.04644450275518237), ('movielens_tags:DVD-RAM', 0.0028863815271582263), ('imdb_keywords:accident', 0.001574389923904487), ('imdb_keywords:truck', 0.0005247966413014956)]
Correctness scores: [(2, 0.01927710843373494), (0, 0.0), (1, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 5.0
New clusters: defaultdict(<type 'int'>, {0.0: 3778, 1.0: 33})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 25 nodes
  If (Isn't movielens_tags:murder)
   Predict: 0.0
  Else (Is movielens_tags:murder)
   If (Is imdb_keywords:f-word)
    If (Is imdb_keywords:severed-head)
     Predict: 0.0
    Else (Isn't imdb_keywords:severed-head)
     Predict: 1.0
   Else (Isn't imdb_keywords:f-word)
    If (Isn't imdb_keywords:depression)
     If (Isn't imdb_keywords:reverse-footage)
      If (Is imdb_keywords:magic)
       Predict: 1.0
      Else (Isn't imdb_keywords:magic)
       If (Isn't imdb_keywords:fish)
        If (Isn't imdb_keywords:hope)
         Predict: 0.0
        Else (Is imdb_keywords:hope)
         If (Isn't movielens_genre:Comedy)
          Predict: 0.0
         Else (Is movielens_genre:Comedy)
          Predict: 1.0
       Else (Is imdb_keywords:fish)
        If (year <= 1960.0)
         Predict: 1.0
        Else (year > 1960.0)
         Predict: 0.0
     Else (Is imdb_keywords:reverse-footage)
      If (Is imdb_keywords:cat)
       Predict: 0.0
      Else (Isn't imdb_keywords:cat)
       Predict: 1.0
    Else (Is imdb_keywords:depression)
     If (Is movielens_genre:Mystery)
      Predict: 0.0
     Else (Isn't movielens_genre:Mystery)
      Predict: 1.0

Done, making predictions
Accuracy of cluster 5.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 5.0 meta tree on test set: 0.994787141616
{'recall': 0.9090909090909091, 'precision': 0.6666666666666666}
12 features used
QIIs: [('movielens_genre:Comedy', 0.024403043820519547), ('imdb_keywords:depression', 0.01102072946733141), ('imdb_keywords:severed-head', 0.005247966413014957), ('imdb_keywords:fish', 0.004985568092364209), ('imdb_keywords:hope', 0.0028863815271582263), ('movielens_tags:murder', 0.0023615848858567303), ('imdb_keywords:reverse-footage', 0.0010495932826029913), ('imdb_keywords:cat', 0.0010495932826029913), ('imdb_keywords:magic', 0.0007871949619522435), ('year', 0.0002623983206507478), ('imdb_keywords:f-word', 0.0002623983206507478), ('movielens_genre:Mystery', 0.0002623983206507478)]
Correctness scores: [(3, 0.3111111111111111), (5, 0.21481481481481482), (6, 0.08148148148148149), (8, 0.029629629629629627), (0, 0.007407407407407407), (1, 0.0), (2, 0.0), (4, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 6.0
New clusters: defaultdict(<type 'int'>, {0.0: 3314, 1.0: 497})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 4 with 13 nodes
  If (average_rating <= 2.0)
   If (Is imdb_keywords:bathroom)
    If (Isn't imdb_keywords:severed-head)
     If (Isn't movielens_genre:Film-Noir)
      Predict: 0.0
     Else (Is movielens_genre:Film-Noir)
      Predict: 1.0
    Else (Is imdb_keywords:severed-head)
     If (Is imdb_keywords:actor)
      Predict: 0.0
     Else (Isn't imdb_keywords:actor)
      Predict: 1.0
   Else (Isn't imdb_keywords:bathroom)
    If (Is imdb_keywords:truck)
     Predict: 0.0
    Else (Isn't imdb_keywords:truck)
     Predict: 1.0
  Else (average_rating > 2.0)
   Predict: 0.0

Done, making predictions
Accuracy of cluster 6.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 6.0 meta tree on test set: 0.999115826702
{'recall': 1.0, 'precision': 0.9935064935064936}
6 features used
QIIs: [('imdb_keywords:actor', 0.24035686171608503), ('imdb_keywords:severed-head', 0.0543164523747048), ('imdb_keywords:truck', 0.045394909472579376), ('movielens_genre:Film-Noir', 0.007347152978220939), ('imdb_keywords:bathroom', 0.0010495932826029913), ('average_rating', 0.0002623983206507478)]
Correctness scores: [(5, 0.18432769367764915), (2, 0.15405164737310773), (0, 0.0035618878005342827), (1, 0.0), (3, 0.0), (4, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 7.0
New clusters: defaultdict(<type 'int'>, {0.0: 3693, 1.0: 118})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 4 with 9 nodes
  If (Isn't imdb_keywords:curse)
   Predict: 0.0
  Else (Is imdb_keywords:curse)
   If (Is imdb_keywords:accident)
    Predict: 0.0
   Else (Isn't imdb_keywords:accident)
    If (Is tvtropes:too dumb to live)
     If (Isn't movielens_genre:Sci-Fi)
      Predict: 0.0
     Else (Is movielens_genre:Sci-Fi)
      Predict: 1.0
    Else (Isn't tvtropes:too dumb to live)
     Predict: 1.0

Done, making predictions
Accuracy of cluster 7.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 7.0 meta tree on test set: 1.0
{'recall': 1.0, 'precision': 1.0}
4 features used
QIIs: [('imdb_keywords:curse', 0.05851482550511677), ('movielens_genre:Sci-Fi', 0.004723169771713461), ('tvtropes:too dumb to live', 0.0020991865652059826), ('imdb_keywords:accident', 0.0002623983206507478)]
Correctness scores: [(1, 0.95850622406639), (2, 0.004149377593360996), (0, 0.0), (3, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 8.0
New clusters: defaultdict(<type 'int'>, {0.0: 3683, 1.0: 128})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 23 nodes
  If (Isn't imdb_keywords:reverse-footage)
   Predict: 0.0
  Else (Is imdb_keywords:reverse-footage)
   If (Is imdb_keywords:f-word)
    Predict: 0.0
   Else (Isn't imdb_keywords:f-word)
    If (Is imdb_keywords:curse)
     If (Isn't movielens_tags:DVD-R)
      Predict: 0.0
     Else (Is movielens_tags:DVD-R)
      Predict: 1.0
    Else (Isn't imdb_keywords:curse)
     If (Is imdb_keywords:accident)
      Predict: 0.0
     Else (Isn't imdb_keywords:accident)
      If (Is imdb_keywords:hope)
       Predict: 0.0
      Else (Isn't imdb_keywords:hope)
       If (Is movielens_tags:murder)
        If (Isn't movielens_genre:Crime)
         Predict: 0.0
        Else (Is movielens_genre:Crime)
         Predict: 1.0
       Else (Isn't movielens_tags:murder)
        If (Is imdb_keywords:chinese)
         If (Is movielens_genre:Thriller)
          Predict: 0.0
         Else (Isn't movielens_genre:Thriller)
          Predict: 1.0
        Else (Isn't imdb_keywords:chinese)
         If (Is imdb_keywords:depression)
          Predict: 0.0
         Else (Isn't imdb_keywords:depression)
          Predict: 1.0

Done, making predictions
Accuracy of cluster 8.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 8.0 meta tree on test set: 0.998281786942
{'recall': 0.9761904761904762, 'precision': 0.9761904761904762}
11 features used
QIIs: [('imdb_keywords:curse', 0.06533718184203621), ('imdb_keywords:hope', 0.010758331146680662), ('movielens_genre:Thriller', 0.004460771451062713), ('imdb_keywords:f-word', 0.0036735764891104696), ('imdb_keywords:accident', 0.0028863815271582263), ('movielens_genre:Crime', 0.0023615848858567303), ('movielens_tags:murder', 0.001574389923904487), ('imdb_keywords:chinese', 0.0007871949619522435), ('imdb_keywords:depression', 0.0007871949619522435), ('movielens_tags:DVD-R', 0.0005247966413014956)]
Correctness scores: [(1, 0.8586206896551724), (6, 0.1413793103448276), (0, 0.04827586206896552), (2, 0.03793103448275862), (5, 0.020689655172413793), (3, 0.010344827586206896), (8, 0.010344827586206896), (4, 0.0), (7, 0.0), (9, 0.0)]
Processing cluster 9.0
New clusters: defaultdict(<type 'int'>, {0.0: 3590, 1.0: 221})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 6 with 19 nodes
  If (Isn't imdb_keywords:depression)
   Predict: 0.0
  Else (Is imdb_keywords:depression)
   If (Is imdb_keywords:f-word)
    If (Isn't imdb_keywords:bathroom)
     Predict: 0.0
    Else (Is imdb_keywords:bathroom)
     If (year <= 2013.0)
      Predict: 1.0
     Else (year > 2013.0)
      Predict: 0.0
   Else (Isn't imdb_keywords:f-word)
    If (Is imdb_keywords:hope)
     If (Is movielens_genre:Drama)
      Predict: 0.0
     Else (Isn't movielens_genre:Drama)
      Predict: 1.0
    Else (Isn't imdb_keywords:hope)
     If (Is imdb_keywords:accident)
      Predict: 0.0
     Else (Isn't imdb_keywords:accident)
      If (Is movielens_tags:murder)
       Predict: 0.0
      Else (Isn't movielens_tags:murder)
       If (Is imdb_keywords:curse)
        Predict: 0.0
       Else (Isn't imdb_keywords:curse)
        Predict: 1.0

Done, making predictions
Accuracy of cluster 9.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 9.0 meta tree on test set: 0.997487437186
{'recall': 0.9833333333333333, 'precision': 0.9672131147540983}
9 features used
QIIs: [('imdb_keywords:curse', 0.10705851482550512), ('imdb_keywords:hope', 0.010758331146680662), ('imdb_keywords:accident', 0.004723169771713461), ('movielens_genre:Drama', 0.004460771451062713), ('imdb_keywords:f-word', 0.004198373130411965), ('movielens_tags:murder', 0.003148779847808974), ('imdb_keywords:depression', 0.0023615848858567303), ('imdb_keywords:bathroom', 0.001574389923904487), ('year', 0.0002623983206507478)]
Correctness scores: [(1, 0.9086859688195991), (6, 0.09131403118040089), (0, 0.0489977728285078), (2, 0.04008908685968819), (5, 0.026726057906458798), (3, 0.020044543429844096), (4, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 10.0
New clusters: defaultdict(<type 'int'>, {0.0: 3651, 1.0: 160})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 6 with 15 nodes
  If (Isn't imdb_keywords:hope)
   Predict: 0.0
  Else (Is imdb_keywords:hope)
   If (Is imdb_keywords:mission)
    If (Isn't imdb_keywords:bow-and-arrow)
     Predict: 0.0
    Else (Is imdb_keywords:bow-and-arrow)
     Predict: 1.0
   Else (Isn't imdb_keywords:mission)
    If (Is movielens_tags:murder)
     Predict: 0.0
    Else (Isn't movielens_tags:murder)
     If (Is imdb_keywords:curse)
      Predict: 0.0
     Else (Isn't imdb_keywords:curse)
      If (Is imdb_keywords:accident)
       Predict: 0.0
      Else (Isn't imdb_keywords:accident)
       If (year <= 2014.0)
        Predict: 1.0
       Else (year > 2014.0)
        Predict: 0.0

Done, making predictions
Accuracy of cluster 10.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 10.0 meta tree on test set: 0.997433704021
{'recall': 0.9333333333333333, 'precision': 1.0}
7 features used
QIIs: [('imdb_keywords:mission', 0.07924429283652584), ('imdb_keywords:hope', 0.004985568092364209), ('imdb_keywords:accident', 0.004198373130411965), ('movielens_tags:murder', 0.0036735764891104696), ('imdb_keywords:bow-and-arrow', 0.0036735764891104696), ('year', 0.0005247966413014956), ('imdb_keywords:curse', 0.0002623983206507478)]
Correctness scores: [(6, 1.0), (2, 0.04984423676012461), (5, 0.04361370716510903), (1, 0.003115264797507788), (0, 0.0), (3, 0.0), (4, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 11.0
New clusters: defaultdict(<type 'int'>, {0.0: 3442, 1.0: 369})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 25 nodes
  If (Isn't imdb_keywords:rape)
   Predict: 0.0
  Else (Is imdb_keywords:rape)
   If (Is imdb_keywords:f-word)
    If (Isn't imdb_keywords:bra)
     Predict: 0.0
    Else (Is imdb_keywords:bra)
     Predict: 1.0
   Else (Isn't imdb_keywords:f-word)
    If (Is tvtropes:oh crap)
     If (Isn't movielens_genre:Adventure)
      Predict: 0.0
     Else (Is movielens_genre:Adventure)
      Predict: 1.0
    Else (Isn't tvtropes:oh crap)
     If (Is imdb_keywords:depression)
      If (Isn't imdb_keywords:adoption)
       Predict: 0.0
      Else (Is imdb_keywords:adoption)
       Predict: 1.0
     Else (Isn't imdb_keywords:depression)
      If (Is imdb_keywords:curse)
       Predict: 0.0
      Else (Isn't imdb_keywords:curse)
       If (Is imdb_keywords:reverse-footage)
        Predict: 0.0
       Else (Isn't imdb_keywords:reverse-footage)
        If (Is movielens_tags:murder)
         If (Isn't imdb_keywords:severed-head)
          Predict: 0.0
         Else (Is imdb_keywords:severed-head)
          Predict: 1.0
        Else (Isn't movielens_tags:murder)
         If (Is imdb_keywords:accident)
          Predict: 0.0
         Else (Isn't imdb_keywords:accident)
          Predict: 1.0

Done, making predictions
Accuracy of cluster 11.0 meta tree on training set: 0.997346474602
{'recall': 0.9959349593495935, 'precision': 0.9760956175298805}
Accuracy of cluster 11.0 meta tree on test set: 0.994884910486
{'recall': 0.975609756097561, 'precision': 0.975609756097561}
12 features used
QIIs: [('tvtropes:oh crap', 0.1595381789556547), ('imdb_keywords:bra', 0.01784308580425085), ('imdb_keywords:curse', 0.017580687483600105), ('imdb_keywords:severed-head', 0.012857517711886644), ('imdb_keywords:reverse-footage', 0.009971136184728419), ('movielens_genre:Adventure', 0.008921542902125426), ('imdb_keywords:adoption', 0.006297559695617948), ('imdb_keywords:accident', 0.005247966413014957), ('imdb_keywords:f-word', 0.0023615848858567303), ('imdb_keywords:rape', 0.0023615848858567303), ('movielens_tags:murder', 0.0018367882445552348), ('imdb_keywords:depression', 0.0005247966413014956)]
Correctness scores: [(9, 0.8994082840236687), (1, 0.09911242603550297), (5, 0.08284023668639053), (8, 0.05621301775147929), (2, 0.02958579881656805), (0, 0.01331360946745562), (7, 0.01331360946745562), (3, 0.0029585798816568047), (4, 0.0), (6, 0.0)]
Processing cluster 12.0
New clusters: defaultdict(<type 'int'>, {0.0: 3748, 1.0: 63})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 5 with 17 nodes
  If (Isn't imdb_keywords:f-word)
   Predict: 0.0
  Else (Is imdb_keywords:f-word)
   If (Isn't imdb_keywords:rape)
    If (Isn't imdb_keywords:depression)
     Predict: 0.0
    Else (Is imdb_keywords:depression)
     If (average_rating <= 3.674922600619195)
      Predict: 0.0
     Else (average_rating > 3.674922600619195)
      If (Is movielens_tags:cinematography)
       Predict: 0.0
      Else (Isn't movielens_tags:cinematography)
       Predict: 1.0
   Else (Is imdb_keywords:rape)
    If (Is imdb_keywords:bathroom)
     Predict: 0.0
    Else (Isn't imdb_keywords:bathroom)
     If (Is imdb_keywords:villain)
      Predict: 0.0
     Else (Isn't imdb_keywords:villain)
      If (Is imdb_keywords:courage)
       Predict: 0.0
      Else (Isn't imdb_keywords:courage)
       Predict: 1.0

Done, making predictions
Accuracy of cluster 12.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 12.0 meta tree on test set: 0.996412556054
{'recall': 0.8461538461538461, 'precision': 0.8461538461538461}
8 features used
QIIs: [('imdb_keywords:bathroom', 0.032274993440041984), ('average_rating', 0.02177906061401207), ('imdb_keywords:villain', 0.010495932826029914), ('imdb_keywords:courage', 0.004198373130411965), ('movielens_tags:cinematography', 0.003935974809761217), ('imdb_keywords:rape', 0.0007871949619522435), ('imdb_keywords:f-word', 0.0005247966413014956), ('imdb_keywords:depression', 0.0002623983206507478)]
Correctness scores: [(0, 0.6067961165048544), (7, 0.014563106796116504), (3, 0.0048543689320388345), (1, 0.0), (2, 0.0), (4, 0.0), (5, 0.0), (6, 0.0), (8, 0.0), (9, 0.0)]
Processing cluster 13.0
New clusters: defaultdict(<type 'int'>, {0.0: 3004, 1.0: 807})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 35 nodes
  If (Isn't imdb_keywords:chase)
   Predict: 0.0
  Else (Is imdb_keywords:chase)
   If (Is imdb_keywords:f-word)
    If (Isn't imdb_keywords:bathroom)
     Predict: 0.0
    Else (Is imdb_keywords:bathroom)
     If (Isn't imdb_keywords:eating)
      If (year <= 1990.0)
       Predict: 1.0
      Else (year > 1990.0)
       Predict: 0.0
     Else (Is imdb_keywords:eating)
      Predict: 1.0
   Else (Isn't imdb_keywords:f-word)
    If (Is tvtropes:oh crap)
     If (Isn't movielens_genre:Musical)
      Predict: 0.0
     Else (Is movielens_genre:Musical)
      Predict: 1.0
    Else (Isn't tvtropes:oh crap)
     If (Is imdb_keywords:rape)
      If (Isn't imdb_keywords:u.s.-army)
       Predict: 0.0
      Else (Is imdb_keywords:u.s.-army)
       Predict: 1.0
     Else (Isn't imdb_keywords:rape)
      If (Is movielens_tags:murder)
       If (Isn't imdb_keywords:severed-head)
        Predict: 0.0
       Else (Is imdb_keywords:severed-head)
        If (Isn't movielens_genre:Thriller)
         Predict: 0.0
        Else (Is movielens_genre:Thriller)
         Predict: 1.0
      Else (Isn't movielens_tags:murder)
       If (Is imdb_keywords:reverse-footage)
        If (Isn't movielens_tags:comedy)
         Predict: 0.0
        Else (Is movielens_tags:comedy)
         Predict: 1.0
       Else (Isn't imdb_keywords:reverse-footage)
        If (Is imdb_keywords:hope)
         If (Isn't imdb_keywords:mission)
          Predict: 0.0
         Else (Is imdb_keywords:mission)
          Predict: 1.0
        Else (Isn't imdb_keywords:hope)
         If (Is imdb_keywords:depression)
          Predict: 0.0
         Else (Isn't imdb_keywords:depression)
          Predict: 1.0

Done, making predictions
Accuracy of cluster 13.0 meta tree on training set: 0.991522300037
{'recall': 1.0, 'precision': 0.962171052631579}
Accuracy of cluster 13.0 meta tree on test set: 0.97723132969
{'recall': 0.9504504504504504, 'precision': 0.9377777777777778}
17 features used
QIIs: [('movielens_genre:Thriller', 0.23825767515087903), ('imdb_keywords:severed-head', 0.05772763054316452), ('imdb_keywords:eating', 0.04959328260299134), ('tvtropes:oh crap', 0.0482812909997376), ('movielens_tags:murder', 0.025977433744424034), ('imdb_keywords:bathroom', 0.023615848858567306), ('imdb_keywords:reverse-footage', 0.02204145893466282), ('imdb_keywords:u.s.-army', 0.020204670690107583), ('imdb_keywords:depression', 0.004198373130411965), ('imdb_keywords:mission', 0.0023615848858567303), ('imdb_keywords:chase', 0.001574389923904487), ('movielens_tags:comedy', 0.001574389923904487), ('imdb_keywords:f-word', 0.0013119916032537393), ('movielens_genre:Musical', 0.0013119916032537393), ('imdb_keywords:rape', 0.0013119916032537393), ('year', 0.0007871949619522435), ('imdb_keywords:hope', 0.0005247966413014956)]
Correctness scores: [(5, 0.2828014184397163), (9, 0.1631205673758865), (0, 0.08421985815602837), (8, 0.07446808510638298), (7, 0.0726950354609929), (3, 0.014184397163120565), (6, 0.009751773049645389), (4, 0.005319148936170213), (1, 0.0), (2, 0.0)]
Processing cluster 14.0
New clusters: defaultdict(<type 'int'>, {0.0: 3602, 1.0: 209})
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 6 with 21 nodes
  If (Isn't imdb_keywords:bathroom)
   Predict: 0.0
  Else (Is imdb_keywords:bathroom)
   If (average_rating <= 2.3236298292902067)
    If (Is imdb_keywords:truck)
     If (year <= 2007.0)
      Predict: 0.0
     Else (year > 2007.0)
      Predict: 1.0
    Else (Isn't imdb_keywords:truck)
     If (Is imdb_keywords:severed-head)
      Predict: 0.0
     Else (Isn't imdb_keywords:severed-head)
      If (Is movielens_genre:Film-Noir)
       Predict: 0.0
      Else (Isn't movielens_genre:Film-Noir)
       Predict: 1.0
   Else (average_rating > 2.3236298292902067)
    If (Isn't imdb_keywords:f-word)
     Predict: 0.0
    Else (Is imdb_keywords:f-word)
     If (average_rating <= 3.0054901960784313)
      If (Is imdb_keywords:rifle)
       Predict: 0.0
      Else (Isn't imdb_keywords:rifle)
       If (Is imdb_keywords:prayer)
        Predict: 0.0
       Else (Isn't imdb_keywords:prayer)
        Predict: 1.0
     Else (average_rating > 3.0054901960784313)
      Predict: 0.0

Done, making predictions
Accuracy of cluster 14.0 meta tree on training set: 1.0
{'recall': 1.0, 'precision': 1.0}
Accuracy of cluster 14.0 meta tree on test set: 0.996615905245
{'recall': 0.9841269841269841, 'precision': 0.9538461538461539}
9 features used
QIIs: [('imdb_keywords:prayer', 0.061401207032274994), ('imdb_keywords:bathroom', 0.05799002886381527), ('imdb_keywords:truck', 0.009708737864077669), ('movielens_genre:Film-Noir', 0.00839674626082393), ('imdb_keywords:severed-head', 0.007609551298871687), ('imdb_keywords:rifle', 0.0026239832065074785), ('year', 0.0013119916032537393), ('average_rating', 0.0013119916032537393), ('imdb_keywords:f-word', 0.0007871949619522435)]
Correctness scores: [(0, 0.4923076923076923), (2, 0.08131868131868131), (5, 0.06373626373626373), (1, 0.0), (3, 0.0), (4, 0.0), (6, 0.0), (7, 0.0), (8, 0.0), (9, 0.0)]
All highers corrs: [1.0, 0.15647921760391198, 0.8715596330275228, 0.8724409448818897, 0.01927710843373494, 0.3111111111111111, 0.18432769367764915, 0.95850622406639, 0.8586206896551724, 0.9086859688195991, 1.0, 0.8994082840236687, 0.6067961165048544, 0.2828014184397163, 0.4923076923076923]
Their profiles: [2, 5, 3, 2, 2, 3, 5, 1, 1, 1, 6, 9, 0, 5, 0]
7 profiles represented
Average: 0.628154806837
Results: {0: {'cluster': 12.0, 'corr': 0.6067961165048544}, 1: {'cluster': 7.0, 'corr': 0.95850622406639}, 2: {'cluster': 0.0, 'corr': 1.0}, 3: {'cluster': 2.0, 'corr': 0.8715596330275228}, 5: {'cluster': 13.0, 'corr': 0.2828014184397163}, 6: {'cluster': 10.0, 'corr': 1.0}, 9: {'cluster': 11.0, 'corr': 0.8994082840236687}}
Average corr: 0.802724525152
