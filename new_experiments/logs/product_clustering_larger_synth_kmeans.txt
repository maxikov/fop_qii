Sun Jul 2 12:10:38 PDT 2017 spark-submit --driver-memory 10g product_clustering.py --persist-dir new_experiments/product_regression_all_regression_tree_rank_12_depth_5_larger_synth.state/ --user-profiles new_experiments/synth_data_set/profiles.pkl --n-clusters 15 --cluster-model kmeans --movies-file datasets/ml-20m/movies.csv >> new_experiments/logs/product_clustering_larger_synth_kmeans.txt
Loading results dict
Loading indicators
Loading ALS model
Loading movies
Done, 27278 movies loaded
Training kmeans
Done
Centroids: [array([ 0.26124815,  0.0407518 ,  0.45858689,  0.21002711, -0.53425575,
       -0.32802451, -0.6638942 , -0.11362731,  0.34313048,  0.91715253,
        0.11716164, -0.85968073]), array([-0.13876328,  0.02649347,  0.56620996,  0.45212421, -0.48215732,
       -0.18628786, -0.35130637,  0.24722151,  1.29763152,  0.21312966,
       -0.15824576, -0.61739672]), array([ 0.13816669,  0.16372489,  0.32823098,  0.23686535, -0.40255591,
       -0.3341036 , -0.1939241 ,  0.09135723,  0.50855461,  0.20514433,
       -0.05442006, -0.09765228]), array([-0.06510478, -0.08917813,  0.57433118,  0.79810566, -0.66832109,
       -0.63322274, -0.60266012, -0.19457379,  1.12097   ,  0.16647265,
       -0.44995879, -0.47147732]), array([-0.20023617,  0.38806804,  0.18513593,  0.6041755 , -0.5911122 ,
        0.06405685, -0.50978225,  0.00340581,  1.26021084,  1.03169481,
       -0.38960094,  0.03335469]), array([-0.23862769,  0.00822104,  0.74151759,  0.81214972, -0.66332372,
       -0.5900884 , -0.4736313 ,  0.09771379,  0.98185667,  0.46821926,
        0.5491703 , -0.09458122]), array([-0.08936899, -0.06319361,  0.67792787,  0.39220345, -0.45615817,
       -0.28729523, -0.31431874,  0.29051219,  1.27694462, -0.06062353,
       -0.07464827, -0.79840332]), array([ 0.17017781,  0.08061177,  0.6147302 ,  0.44489295, -0.73912483,
       -0.38273261, -0.82170473, -0.13554866,  0.82078579,  1.01265552,
        0.01997975, -0.84021091]), array([ 0.23368757,  0.95314953,  0.35172154,  0.17470988, -1.23346871,
       -0.68120296, -0.54108695,  0.10801133,  0.90180556,  0.06070796,
       -0.12884252, -0.4950296 ]), array([ 0.30233722,  0.44904362,  0.76829   ,  0.38373703, -0.35513494,
       -0.2558781 , -0.70562456, -0.14623606,  1.42700538,  0.2457093 ,
       -0.07891052, -0.30155753]), array([-0.19340457,  0.27828464,  0.33803129,  0.38828565, -0.26779943,
       -0.0268954 , -0.38521728,  0.05052613,  0.58358027,  0.48424811,
       -0.26736112,  0.02502944]), array([ 0.56818069,  0.69231892,  0.67080647,  0.21585734, -0.11968908,
       -0.20606846, -0.70754286, -0.29190979,  1.23686018,  0.26372543,
        0.03459989, -0.03132693]), array([ 0.64699384, -0.06753474,  0.96307593,  0.39488863, -0.99368106,
       -0.87407022, -0.02852887,  0.58410524,  0.95339116,  0.71708019,
       -0.40939469,  0.04872493]), array([ 0.07992466, -0.10280116,  0.36929252,  0.85294076, -0.67086867,
       -0.84121318, -0.61534908, -0.48029847,  0.68904392,  0.19483456,
       -0.55822546, -0.18652561]), array([-0.02865211, -0.17162931,  0.3408307 ,  0.31103603, -0.56402675,
       -0.15335589, -0.13994309,  0.28355597,  1.4504666 ,  0.11074157,
        0.02519473, -0.8159931 ])]
Labeling clusters
Clusters: defaultdict(<type 'int'>, {0.0: 225, 1.0: 749, 2.0: 533, 3.0: 86, 4.0: 416, 5.0: 240, 6.0: 65, 7.0: 103, 8.0: 240, 9.0: 121, 10.0: 292, 11.0: 268, 12.0: 143, 13.0: 300, 14.0: 30})
Centroid mean: [ 0.09643727  0.17242205  0.5299146   0.44479995 -0.58277851 -0.38109215
 -0.47030097  0.02628101  0.99014917  0.40205949 -0.12156679 -0.36684841]
Centroid variance: 0.933981500878
Cluster 6 (variance: 0.0768260354719):
	0: (dist: 0.0380821213234) Loneliness of the Long Distance Runner, The (1962) (mid: 26083)
	1: (dist: 0.0380869044068) Blues Harp (1998) (mid: 88886)
	2: (dist: 0.0380916775984) Billy Elliot (2000) (mid: 3967)
	3: (dist: 0.0380951675603) Desperately Seeking Susan (1985) (mid: 2369)
	4: (dist: 0.0380967659633) Little Ashes (2008) (mid: 75446)
	5: (dist: 0.0380971014523) Pi (1998) (mid: 1921)
	6: (dist: 0.0380979564511) Kiss Before Dying, A (1991) (mid: 26734)
	7: (dist: 0.0381003388875) Flightplan (2005) (mid: 37727)
	8: (dist: 0.0381045439823) 1408 (2007) (mid: 53953)
	9: (dist: 0.0381045852229) Paddington (2014) (mid: 117887)
Cluster 11 (variance: 0.0797784645023):
	0: (dist: 0.0445629152002) Romancing the Stone (1984) (mid: 2406)
	1: (dist: 0.0445882397856) Unforgiven, The (1960) (mid: 6461)
	2: (dist: 0.0445961108987) Island, The (2005) (mid: 34319)
	3: (dist: 0.0446120705511) Shakespeare in Love (1998) (mid: 2396)
	4: (dist: 0.0446328407488) Police Academy (1984) (mid: 2378)
	5: (dist: 0.0535889089122) Top Gun (1986) (mid: 1101)
	6: (dist: 0.0535902892472) Shocker (1989) (mid: 4665)
	7: (dist: 0.0535907980247) Unbreakable (2000) (mid: 3994)
	8: (dist: 0.053594404568) Kick-Ass (2010) (mid: 76251)
	9: (dist: 0.0535968489716) Innerspace (1987) (mid: 4121)
Cluster 13 (variance: 0.0864913676258):
	0: (dist: 0.0582636953766) New Barbarians, The (I nuovi barbari) (1983) (mid: 99380)
	1: (dist: 0.0583522166991) Seeking Justice (2011) (mid: 92198)
	2: (dist: 0.0640740519416) Straw Dogs (2011) (mid: 89490)
	3: (dist: 0.0640762165013) Temptress Moon (Feng Yue) (1996) (mid: 1514)
	4: (dist: 0.0640762952582) Undefeatable (1993) (mid: 101924)
	5: (dist: 0.0640770560349) I Spit on Your Grave (2010) (mid: 84189)
	6: (dist: 0.0640791107771) Red Road (2006) (mid: 52929)
	7: (dist: 0.0640799095079) Damned, The (La Caduta degli dei) (1969) (mid: 7336)
	8: (dist: 0.064080157677) Ugly, The (1997) (mid: 1891)
	9: (dist: 0.0640802481775) Last of Robin Hood, The (2013) (mid: 104680)
Cluster 1 (variance: 0.0946997191668):
	0: (dist: 0.0630730532284) Beverly Hills Cop III (1994) (mid: 420)
	1: (dist: 0.0630778701519) RoboCop 3 (1993) (mid: 519)
	2: (dist: 0.0630781981346) Adventures of Tom Sawyer, The (1938) (mid: 62974)
	3: (dist: 0.0630782801347) Blast of Silence (1961) (mid: 60745)
	4: (dist: 0.0630813776535) I Inside, The (2004) (mid: 34045)
	5: (dist: 0.0630832112498) Pathfinder (Ofelas) (1987) (mid: 26602)
	6: (dist: 0.0630836543414) Return of the Magnificent Seven, The (a.k.a. Return of the Seven) (1966) (mid: 4328)
	7: (dist: 0.0630836912348) Western (1997) (mid: 82271)
	8: (dist: 0.0630854175313) Dazed and Confused (1993) (mid: 441)
	9: (dist: 0.0630856479399) Driver, The (1978) (mid: 41136)
Cluster 14 (variance: 0.148577876108):
	0: (dist: 0.0941149742642) Blackhat (2015) (mid: 120637)
	1: (dist: 0.0941153532898) Riding Alone for Thousands of Miles (Qian li zou dan qi) (2005) (mid: 42935)
	2: (dist: 0.0941257797582) Rush Hour 2 (2001) (mid: 4701)
	3: (dist: 0.0941268123115) King of California (2007) (mid: 55729)
	4: (dist: 0.0941312684432) Bulletproof Monk (2003) (mid: 6294)
	5: (dist: 0.09414012629) Master, The (Huang Fei Hong jiu er zhi long xing tian xia) (1992) (mid: 98825)
	6: (dist: 0.0941505995501) Day the Earth Stood Still, The (2008) (mid: 64497)
	7: (dist: 0.0967042562687) Frozen River (2008) (mid: 60943)
	8: (dist: 0.0967199387019) Gomorrah (Gomorra) (2008) (mid: 62250)
	9: (dist: 0.115237566599) Young Guns (1988) (mid: 1378)
Cluster 3 (variance: 0.244225778148):
	0: (dist: 0.128539263761) Violent Cop (Sono otoko, kyôbô ni tsuki) (1989) (mid: 32196)
	1: (dist: 0.12853983955) Sea, The (Hafið) (2002) (mid: 35629)
	2: (dist: 0.128543777238) Alex Cross (2012) (mid: 97742)
	3: (dist: 0.128544069223) Slumdog Millionaire (2008) (mid: 63082)
	4: (dist: 0.128546134555) Righteous Kill (2008) (mid: 61697)
	5: (dist: 0.128549266245) House of Flying Daggers (Shi mian mai fu) (2004) (mid: 8983)
	6: (dist: 0.128549547694) Death Wish 3 (1985) (mid: 3432)
	7: (dist: 0.128549894583) Dead Calm (1989) (mid: 3203)
	8: (dist: 0.128549913973) City of God (Cidade de Deus) (2002) (mid: 6016)
	9: (dist: 0.128549942094) Rooster Cogburn (1975) (mid: 7617)
Cluster 0 (variance: 0.250064653113):
	0: (dist: 0.171217198071) Places in the Heart (1984) (mid: 3111)
	1: (dist: 0.171217339134) Mumford (1999) (mid: 2883)
	2: (dist: 0.171217658308) Good Mother, The (1988) (mid: 3449)
	3: (dist: 0.171218483584) Crime of Father Amaro, The (Crimen del padre Amaro, El) (2002) (mid: 5818)
	4: (dist: 0.232244531047) Stage Door (1937) (mid: 25841)
	5: (dist: 0.342181886686) Imaginary Heroes (2004) (mid: 31114)
	6: (dist: 0.342186890533) Reign Over Me (2007) (mid: 51931)
	7: (dist: 0.342198456598) Ikiru (1952) (mid: 6669)
	8: (dist: 0.342206635817) Snow Cake (2006) (mid: 49312)
	9: (dist: 0.342221804172) Charlotte's Web (1973) (mid: 2137)
Cluster 4 (variance: 0.317166266564):
	0: (dist: 0.197691536345) Casino (1995) (mid: 16)
	1: (dist: 0.197696855653) Get Shorty (1995) (mid: 21)
	2: (dist: 0.197714496403) This Is Spinal Tap (1984) (mid: 1288)
	3: (dist: 0.197732547828) Night of the Creeps (1986) (mid: 3696)
	4: (dist: 0.197741728228) Deception (2013) (mid: 124857)
	5: (dist: 0.197743592126) Machine Gun Preacher (2011) (mid: 90624)
	6: (dist: 0.202405227428) Kick-Ass 2 (2013) (mid: 104241)
	7: (dist: 0.202413342476) Hangover Part III, The (2013) (mid: 102686)
	8: (dist: 0.202420601919) Hardware (1990) (mid: 34292)
	9: (dist: 0.202421813633) Paranormal Activity: The Marked Ones (2014) (mid: 107769)
Cluster 2 (variance: 0.331903412804):
	0: (dist: 0.418317442715) Five People You Meet in Heaven, The (2004) (mid: 31889)
	1: (dist: 0.450635408977) Gentlemen Don't Eat Poets (Grotesque, The) (1995) (mid: 107281)
	2: (dist: 0.45063586035) Man Is Not a Bird (Covek nije tica) (1965) (mid: 96451)
	3: (dist: 0.450638166915) End of the Spear (2005) (mid: 46919)
	4: (dist: 0.450641626022) Mogambo (1953) (mid: 7822)
	5: (dist: 0.450645209864) Next of Kin (1989) (mid: 4629)
	6: (dist: 0.455512739776) Notebook, The (2004) (mid: 8533)
	7: (dist: 0.457026517256) There Was a Crooked Man... (1970) (mid: 73111)
	8: (dist: 0.457033569091) Bad Lieutenant: Port of Call New Orleans (2009) (mid: 72405)
	9: (dist: 0.457577440558) Carnages (a.k.a. Carnage) (2002) (mid: 6622)
Cluster 10 (variance: 0.355360780077):
	0: (dist: 0.355455215743) Jersey Girl (2004) (mid: 7366)
	1: (dist: 0.355456332362) This Girl's Life (2003) (mid: 31362)
	2: (dist: 0.355463452521) Running Scared (2006) (mid: 43921)
	3: (dist: 0.355468057229) Man on the Moon (1999) (mid: 3174)
	4: (dist: 0.355472940215) 9 Songs (2004) (mid: 33585)
	5: (dist: 0.395953767799) V/H/S/2 (2013) (mid: 103483)
	6: (dist: 0.395955762855) Friends with Money (2006) (mid: 44864)
	7: (dist: 0.395958254952) Valley Girl (1983) (mid: 6638)
	8: (dist: 0.395958759677) House of D (2004) (mid: 33136)
	9: (dist: 0.39596138616) Supervixens (1975) (mid: 26356)
Cluster 8 (variance: 0.376315000858):
	0: (dist: 0.189226699013) Rocky Horror Picture Show, The (1975) (mid: 2657)
	1: (dist: 0.189234455918) Secret Window (2004) (mid: 7347)
	2: (dist: 0.20916960552) Snow White and the Huntsman (2012) (mid: 94780)
	3: (dist: 0.214486712037) Manchurian Candidate, The (1962) (mid: 1267)
	4: (dist: 0.214490400817) Tingler, The (1959) (mid: 2781)
	5: (dist: 0.214490525563) Sherlock Holmes: A Game of Shadows (2011) (mid: 91542)
	6: (dist: 0.214490686159) Big Sleep, The (1946) (mid: 1284)
	7: (dist: 0.214491281641) Sling Blade (1996) (mid: 1358)
	8: (dist: 0.214491886212) Hamlet (2000) (mid: 3598)
	9: (dist: 0.214492861854) Dead Man's Shoes (2004) (mid: 40412)
Cluster 9 (variance: 0.393264515248):
	0: (dist: 0.140102879853) Nancy Drew (2007) (mid: 53466)
	1: (dist: 0.140108894786) Westworld (1973) (mid: 2527)
	2: (dist: 0.140119394529) Rumble in the Bronx (Hont faan kui) (1995) (mid: 112)
	3: (dist: 0.140119566418) Imaginarium of Doctor Parnassus, The (2009) (mid: 69951)
	4: (dist: 0.140125920185) Nine (2009) (mid: 73000)
	5: (dist: 0.140134776935) Back to the Future (1985) (mid: 1270)
	6: (dist: 0.140136564227) Croods, The (2013) (mid: 101142)
	7: (dist: 0.140137086934) Notorious (2009) (mid: 65810)
	8: (dist: 0.140138014923) Galaxy Quest (1999) (mid: 3175)
	9: (dist: 0.140138479503) Shadow of a Doubt (1943) (mid: 2203)
Cluster 12 (variance: 0.395910126458):
	0: (dist: 0.143428931479) Picture of Dorian Gray, The (1945) (mid: 8482)
	1: (dist: 0.143431629214) Bitter Moon (1992) (mid: 347)
	2: (dist: 0.143433263572) Lookout, The (2007) (mid: 52241)
	3: (dist: 0.143435262071) The Chumscrubber (2005) (mid: 34523)
	4: (dist: 0.143435373328) Judgement in Stone, A (Cérémonie, La) (1995) (mid: 1406)
	5: (dist: 0.143436172244) Color of Paradise, The (Rang-e khoda) (1999) (mid: 3456)
	6: (dist: 0.143436778259) Jane Austen Book Club, The (2007) (mid: 55451)
	7: (dist: 0.143436985033) Stranger than Fiction (2006) (mid: 46976)
	8: (dist: 0.143437121884) Man of Marble (Czlowiek z Marmuru) (1977) (mid: 6921)
	9: (dist: 0.143438169838) Youngblood (1986) (mid: 4355)
Cluster 7 (variance: 0.487295884058):
	0: (dist: 0.229412696388) Trainspotting (1996) (mid: 778)
	1: (dist: 0.277396345406) 16 Blocks (2006) (mid: 43936)
	2: (dist: 0.277408610647) Persepolis (2007) (mid: 55442)
	3: (dist: 0.277410258806) Lonesome Jim (2005) (mid: 40887)
	4: (dist: 0.277412075109) Analyze That (2002) (mid: 5900)
	5: (dist: 0.27741646993) Footprints on the Moon (Le orme) (Primal Impulse) (1975) (mid: 107370)
	6: (dist: 0.277437355464) Powder (1995) (mid: 24)
	7: (dist: 0.277441003185) Last Picture Show, The (1971) (mid: 3152)
	8: (dist: 0.277442630278) Into the Abyss (2011) (mid: 90943)
	9: (dist: 0.277444835955) Moonrise Kingdom (2012) (mid: 94959)
Cluster 5 (variance: 1.11760255247):
	0: (dist: 0.562933627692) Nicholas Nickleby (2002) (mid: 5994)
	1: (dist: 0.592399903315) Leprechaun (1993) (mid: 7117)
	2: (dist: 0.592413804559) The Water Diviner (2014) (mid: 117871)
	3: (dist: 0.592433826375) Dracula Untold (2014) (mid: 114795)
	4: (dist: 0.771488069826) Seven Samurai (Shichinin no samurai) (1954) (mid: 2019)
	5: (dist: 0.771507205285) Behind the Sun (Abril Despedaçado) (2001) (mid: 5314)
	6: (dist: 0.771518172679) Village, The (2004) (mid: 8783)
	7: (dist: 0.771518471252) Ewoks: The Battle for Endor (1985) (mid: 26542)
	8: (dist: 0.771520391227) Masters of the Universe (1987) (mid: 4133)
	9: (dist: 0.771520668447) Terminal Man, The (1974) (mid: 26333)
Training a latent tree
DecisionTreeModel classifier of depth 8 with 147 nodes
  If (feature 11 <= -0.41174599528312683)
   If (feature 0 <= -0.07375913113355637)
    If (feature 9 <= -0.005961590446531773)
     If (feature 5 <= -0.6448153853416443)
      If (feature 0 <= -0.3239854872226715)
       Predict: 8.0
      Else (feature 0 > -0.3239854872226715)
       Predict: 3.0
     Else (feature 5 > -0.6448153853416443)
      Predict: 6.0
    Else (feature 9 > -0.005961590446531773)
     If (feature 7 <= 0.06803255528211594)
      If (feature 9 <= 0.3714487850666046)
       If (feature 2 <= 0.6291773319244385)
        Predict: 3.0
       Else (feature 2 > 0.6291773319244385)
        Predict: 5.0
      Else (feature 9 > 0.3714487850666046)
       If (feature 1 <= -0.1119588166475296)
        Predict: 7.0
       Else (feature 1 > -0.1119588166475296)
        Predict: 8.0
     Else (feature 7 > 0.06803255528211594)
      If (feature 10 <= 0.20181100070476532)
       If (feature 6 <= -0.1697140634059906)
        If (feature 5 <= -0.24585767090320587)
         If (feature 0 <= -0.23403017222881317)
          Predict: 6.0
         Else (feature 0 > -0.23403017222881317)
          Predict: 1.0
        Else (feature 5 > -0.24585767090320587)
         Predict: 1.0
       Else (feature 6 > -0.1697140634059906)
        If (feature 3 <= 0.41630643606185913)
         Predict: 14.0
        Else (feature 3 > 0.41630643606185913)
         If (feature 0 <= -0.4214886724948883)
          Predict: 4.0
         Else (feature 0 > -0.4214886724948883)
          Predict: 1.0
      Else (feature 10 > 0.20181100070476532)
       If (feature 1 <= -0.02893838845193386)
        Predict: 5.0
       Else (feature 1 > -0.02893838845193386)
        Predict: 8.0
   Else (feature 0 > -0.07375913113355637)
    If (feature 8 <= 0.4582540690898895)
     If (feature 5 <= -0.6448153853416443)
      If (feature 1 <= 0.2114412933588028)
       Predict: 7.0
      Else (feature 1 > 0.2114412933588028)
       Predict: 8.0
     Else (feature 5 > -0.6448153853416443)
      If (feature 1 <= 0.14727351069450378)
       Predict: 0.0
      Else (feature 1 > 0.14727351069450378)
       Predict: 2.0
    Else (feature 8 > 0.4582540690898895)
     If (feature 1 <= 0.5600569248199463)
      If (feature 9 <= 0.3714487850666046)
       If (feature 3 <= 0.44836854934692383)
        If (feature 1 <= -0.1119588166475296)
         If (feature 0 <= 0.06638699769973755)
          Predict: 14.0
         Else (feature 0 > 0.06638699769973755)
          Predict: 12.0
        Else (feature 1 > -0.1119588166475296)
         If (feature 7 <= 0.20339375734329224)
          Predict: 9.0
         Else (feature 7 > 0.20339375734329224)
          Predict: 6.0
       Else (feature 3 > 0.44836854934692383)
        If (feature 2 <= 0.14390705525875092)
         Predict: 5.0
        Else (feature 2 > 0.14390705525875092)
         Predict: 3.0
      Else (feature 9 > 0.3714487850666046)
       If (feature 6 <= -0.6223775148391724)
        If (feature 3 <= 0.778046190738678)
         If (feature 8 <= 0.592807412147522)
          Predict: 7.0
         Else (feature 8 > 0.592807412147522)
          Predict: 7.0
        Else (feature 3 > 0.778046190738678)
         Predict: 5.0
       Else (feature 6 > -0.6223775148391724)
        If (feature 0 <= 0.2626937925815582)
         If (feature 1 <= 0.013215486891567707)
          Predict: 0.0
         Else (feature 1 > 0.013215486891567707)
          Predict: 5.0
        Else (feature 0 > 0.2626937925815582)
         Predict: 12.0
     Else (feature 1 > 0.5600569248199463)
      If (feature 4 <= -0.7780070900917053)
       Predict: 8.0
      Else (feature 4 > -0.7780070900917053)
       Predict: 9.0
  Else (feature 11 > -0.41174599528312683)
   If (feature 9 <= 0.7429113388061523)
    If (feature 7 <= -0.26725098490715027)
     If (feature 4 <= -0.35938289761543274)
      If (feature 8 <= 0.9710152745246887)
       If (feature 10 <= -0.07077552378177643)
        Predict: 13.0
       Else (feature 10 > -0.07077552378177643)
        If (feature 0 <= -0.23403017222881317)
         Predict: 5.0
        Else (feature 0 > -0.23403017222881317)
         Predict: 8.0
      Else (feature 8 > 0.9710152745246887)
       If (feature 0 <= -0.07375913113355637)
        If (feature 0 <= -0.11701187491416931)
         Predict: 5.0
        Else (feature 0 > -0.11701187491416931)
         Predict: 4.0
       Else (feature 0 > -0.07375913113355637)
        Predict: 9.0
     Else (feature 4 > -0.35938289761543274)
      If (feature 0 <= 0.3563070595264435)
       Predict: 9.0
      Else (feature 0 > 0.3563070595264435)
       Predict: 11.0
    Else (feature 7 > -0.26725098490715027)
     If (feature 0 <= -0.1110205352306366)
      If (feature 10 <= -0.14886194467544556)
       If (feature 8 <= 0.7904388904571533)
        If (feature 3 <= 0.8468530774116516)
         Predict: 10.0
        Else (feature 3 > 0.8468530774116516)
         If (feature 0 <= -0.4214886724948883)
          Predict: 13.0
         Else (feature 0 > -0.4214886724948883)
          Predict: 3.0
       Else (feature 8 > 0.7904388904571533)
        If (feature 7 <= 0.0049091218970716)
         Predict: 3.0
        Else (feature 7 > 0.0049091218970716)
         If (feature 11 <= -0.2812231779098511)
          Predict: 1.0
         Else (feature 11 > -0.2812231779098511)
          Predict: 4.0
      Else (feature 10 > -0.14886194467544556)
       If (feature 0 <= -0.15150292217731476)
        If (feature 8 <= 0.592807412147522)
         If (feature 1 <= 0.07831062376499176)
          Predict: 10.0
         Else (feature 1 > 0.07831062376499176)
          Predict: 5.0
        Else (feature 8 > 0.592807412147522)
         Predict: 5.0
       Else (feature 0 > -0.15150292217731476)
        If (feature 8 <= 0.592807412147522)
         Predict: 2.0
        Else (feature 8 > 0.592807412147522)
         If (feature 2 <= 0.33276650309562683)
          Predict: 10.0
         Else (feature 2 > 0.33276650309562683)
          Predict: 5.0
     Else (feature 0 > -0.1110205352306366)
      If (feature 8 <= 0.7168846726417542)
       If (feature 1 <= 0.5600569248199463)
        If (feature 2 <= 0.6291773319244385)
         If (feature 5 <= -0.05227535218000412)
          Predict: 2.0
         Else (feature 5 > -0.05227535218000412)
          Predict: 10.0
        Else (feature 2 > 0.6291773319244385)
         Predict: 12.0
       Else (feature 1 > 0.5600569248199463)
        Predict: 8.0
      Else (feature 8 > 0.7168846726417542)
       If (feature 7 <= 0.28924664855003357)
        If (feature 8 <= 1.3567360639572144)
         If (feature 4 <= -1.0303101539611816)
          Predict: 8.0
         Else (feature 4 > -1.0303101539611816)
          Predict: 11.0
        Else (feature 8 > 1.3567360639572144)
         If (feature 11 <= -0.10491152852773666)
          Predict: 9.0
         Else (feature 11 > -0.10491152852773666)
          Predict: 5.0
       Else (feature 7 > 0.28924664855003357)
        If (feature 0 <= 0.2626937925815582)
         If (feature 1 <= 0.2114412933588028)
          Predict: 1.0
         Else (feature 1 > 0.2114412933588028)
          Predict: 8.0
        Else (feature 0 > 0.2626937925815582)
         Predict: 12.0
   Else (feature 9 > 0.7429113388061523)
    If (feature 0 <= 0.29385724663734436)
     If (feature 5 <= -0.43484747409820557)
      If (feature 1 <= 0.5151626467704773)
       Predict: 5.0
      Else (feature 1 > 0.5151626467704773)
       If (feature 0 <= -0.4214886724948883)
        Predict: 8.0
       Else (feature 0 > -0.4214886724948883)
        Predict: 4.0
     Else (feature 5 > -0.43484747409820557)
      If (feature 1 <= -0.2280247062444687)
       Predict: 5.0
      Else (feature 1 > -0.2280247062444687)
       If (feature 8 <= 0.6642184257507324)
        If (feature 0 <= -0.3239854872226715)
         Predict: 4.0
        Else (feature 0 > -0.3239854872226715)
         Predict: 7.0
       Else (feature 8 > 0.6642184257507324)
        If (feature 4 <= -1.0947386026382446)
         If (feature 0 <= -0.23403017222881317)
          Predict: 4.0
         Else (feature 0 > -0.23403017222881317)
          Predict: 5.0
        Else (feature 4 > -1.0947386026382446)
         Predict: 4.0
    Else (feature 0 > 0.29385724663734436)
     Predict: 12.0

Done, making predictions
Accuracy of latent tree on training set: 0.97857689365
Accuracy of latent tree on test set: 0.947368421053
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 133 nodes
  If (average_rating <= 2.0)
   If (Isn't imdb_keywords:bathroom)
    If (Isn't imdb_keywords:doll)
     If (Isn't imdb_keywords:chinese)
      Predict: 2.0
     Else (Is imdb_keywords:chinese)
      If (Isn't imdb_keywords:truck)
       If (Isn't imdb_keywords:severed-head)
        If (Isn't movielens_tags:To See)
         Predict: 10.0
        Else (Is movielens_tags:To See)
         Predict: 2.0
       Else (Is imdb_keywords:severed-head)
        Predict: 2.0
      Else (Is imdb_keywords:truck)
       Predict: 2.0
    Else (Is imdb_keywords:doll)
     If (Isn't imdb_keywords:truck)
      If (Isn't imdb_keywords:courage)
       If (Isn't imdb_keywords:1970s)
        If (Isn't imdb_keywords:court)
         Predict: 0.0
        Else (Is imdb_keywords:court)
         Predict: 2.0
       Else (Is imdb_keywords:1970s)
        Predict: 2.0
      Else (Is imdb_keywords:courage)
       Predict: 2.0
     Else (Is imdb_keywords:truck)
      Predict: 2.0
   Else (Is imdb_keywords:bathroom)
    If (Isn't imdb_keywords:truck)
     If (Isn't imdb_keywords:severed-head)
      Predict: 10.0
     Else (Is imdb_keywords:severed-head)
      Predict: 2.0
    Else (Is imdb_keywords:truck)
     Predict: 2.0
  Else (average_rating > 2.0)
   If (Isn't imdb_keywords:f-word)
    If (Isn't imdb_keywords:chase)
     If (Isn't imdb_keywords:rape)
      If (Isn't tvtropes:oh crap)
       If (Isn't imdb_keywords:depression)
        If (Isn't movielens_tags:murder)
         If (Isn't imdb_keywords:accident)
          Predict: 5.0
         Else (Is imdb_keywords:accident)
          Predict: 12.0
        Else (Is movielens_tags:murder)
         If (Isn't imdb_keywords:accident)
          Predict: 8.0
         Else (Is imdb_keywords:accident)
          Predict: 12.0
       Else (Is imdb_keywords:depression)
        If (Isn't imdb_keywords:hope)
         If (Isn't imdb_keywords:curse)
          Predict: 0.0
         Else (Is imdb_keywords:curse)
          Predict: 5.0
        Else (Is imdb_keywords:hope)
         If (Isn't movielens_tags:Betamax)
          Predict: 7.0
         Else (Is movielens_tags:Betamax)
          Predict: 8.0
      Else (Is tvtropes:oh crap)
       If (Isn't movielens_tags:murder)
        If (Isn't imdb_keywords:reverse-footage)
         If (Isn't imdb_keywords:depression)
          Predict: 11.0
         Else (Is imdb_keywords:depression)
          Predict: 7.0
        Else (Is imdb_keywords:reverse-footage)
         If (Isn't imdb_keywords:snake)
          Predict: 9.0
         Else (Is imdb_keywords:snake)
          Predict: 10.0
       Else (Is movielens_tags:murder)
        Predict: 8.0
     Else (Is imdb_keywords:rape)
      If (Isn't imdb_keywords:depression)
       If (Isn't tvtropes:oh crap)
        If (Isn't imdb_keywords:curse)
         If (Isn't imdb_keywords:accident)
          Predict: 13.0
         Else (Is imdb_keywords:accident)
          Predict: 12.0
        Else (Is imdb_keywords:curse)
         If (Isn't imdb_keywords:mission)
          Predict: 5.0
         Else (Is imdb_keywords:mission)
          Predict: 13.0
       Else (Is tvtropes:oh crap)
        If (Isn't imdb_keywords:assassination-attempt)
         If (year <= 1960.0)
          Predict: 8.0
         Else (year > 1960.0)
          Predict: 9.0
        Else (Is imdb_keywords:assassination-attempt)
         Predict: 11.0
      Else (Is imdb_keywords:depression)
       If (Isn't movielens_tags:murder)
        If (Isn't imdb_keywords:adoption)
         Predict: 7.0
        Else (Is imdb_keywords:adoption)
         Predict: 13.0
       Else (Is movielens_tags:murder)
        Predict: 8.0
    Else (Is imdb_keywords:chase)
     If (Isn't tvtropes:oh crap)
      If (Isn't imdb_keywords:rape)
       If (Isn't imdb_keywords:bathroom)
        If (Isn't movielens_tags:murder)
         If (Isn't imdb_keywords:hope)
          Predict: 1.0
         Else (Is imdb_keywords:hope)
          Predict: 5.0
        Else (Is movielens_tags:murder)
         If (Isn't imdb_keywords:accident)
          Predict: 8.0
         Else (Is imdb_keywords:accident)
          Predict: 12.0
       Else (Is imdb_keywords:bathroom)
        If (average_rating <= 2.9733695652173915)
         If (Isn't imdb_keywords:chinese)
          Predict: 6.0
         Else (Is imdb_keywords:chinese)
          Predict: 14.0
        Else (average_rating > 2.9733695652173915)
         If (Isn't imdb_keywords:depression)
          Predict: 5.0
         Else (Is imdb_keywords:depression)
          Predict: 7.0
      Else (Is imdb_keywords:rape)
       If (Isn't movielens_tags:murder)
        If (Isn't imdb_keywords:accident)
         If (Isn't imdb_keywords:directed-by-star)
          Predict: 3.0
         Else (Is imdb_keywords:directed-by-star)
          Predict: 13.0
        Else (Is imdb_keywords:accident)
         Predict: 12.0
       Else (Is movielens_tags:murder)
        If (Isn't movielens_tags:religion)
         Predict: 8.0
        Else (Is movielens_tags:religion)
         Predict: 3.0
     Else (Is tvtropes:oh crap)
      If (Isn't movielens_tags:murder)
       If (Isn't imdb_keywords:kissing-while-having-sex)
        If (Isn't imdb_keywords:snake)
         If (Isn't imdb_keywords:answering-machine)
          Predict: 9.0
         Else (Is imdb_keywords:answering-machine)
          Predict: 7.0
        Else (Is imdb_keywords:snake)
         If (Isn't imdb_keywords:fistfight)
          Predict: 1.0
         Else (Is imdb_keywords:fistfight)
          Predict: 3.0
       Else (Is imdb_keywords:kissing-while-having-sex)
        If (Isn't movielens_tags:CLV)
         Predict: 11.0
        Else (Is movielens_tags:CLV)
         Predict: 9.0
      Else (Is movielens_tags:murder)
       If (Isn't movielens_tags:ClearPlay)
        Predict: 8.0
       Else (Is movielens_tags:ClearPlay)
        Predict: 3.0
   Else (Is imdb_keywords:f-word)
    If (Isn't imdb_keywords:depression)
     If (Isn't movielens_tags:murder)
      If (Isn't imdb_keywords:accident)
       If (Isn't imdb_keywords:curse)
        If (Isn't imdb_keywords:bathroom)
         If (Isn't imdb_keywords:transformation)
          Predict: 4.0
         Else (Is imdb_keywords:transformation)
          Predict: 4.0
        Else (Is imdb_keywords:bathroom)
         If (Isn't imdb_keywords:chase)
          Predict: 4.0
         Else (Is imdb_keywords:chase)
          Predict: 1.0
       Else (Is imdb_keywords:curse)
        Predict: 5.0
      Else (Is imdb_keywords:accident)
       Predict: 12.0
     Else (Is movielens_tags:murder)
      If (Isn't imdb_keywords:camera)
       Predict: 8.0
      Else (Is imdb_keywords:camera)
       Predict: 4.0
    Else (Is imdb_keywords:depression)
     If (year <= 2014.0)
      Predict: 7.0
     Else (year > 2014.0)
      Predict: 13.0

Done, making predictions
Accuracy of meta tree on training set: 0.943071161049
Accuracy of meta tree on test set: 0.91148115688
35 features used
15 clusters found
Processing cluster 0.0
Traceback (most recent call last):
  File "/longterm/sophiak/fop_qii/product_clustering.py", line 453, in <module>
    main()
  File "/longterm/sophiak/fop_qii/product_clustering.py", line 338, in main
    classifier=True, class_of_interest=cluster)
  File "/longterm/sophiak/fop_qii/tree_qii.py", line 101, in get_tree_qii
    class_of_interest=class_of_interest)
  File "/longterm/sophiak/fop_qii/common_utils.py", line 124, in compute_regression_qii
    signed_err = errs.reudct(lambda a, b: a+b)\
AttributeError: 'PipelinedRDD' object has no attribute 'reudct'
