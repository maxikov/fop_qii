Sun Jul 2 12:13:10 PDT 2017 spark-submit --driver-memory 10g product_clustering.py --persist-dir new_experiments/product_regression_all_regression_tree_rank_12_depth_5_larger_synth.state/ --user-profiles new_experiments/synth_data_set/profiles.pkl --n-clusters 15 --cluster-model kmeans --movies-file datasets/ml-20m/movies.csv >> new_experiments/logs/product_clustering_larger_synth_kmeans.txt
Loading results dict
Loading indicators
Loading ALS model
Loading movies
Done, 27278 movies loaded
Training kmeans
Done
Centroids: [array([ 0.06741102,  0.16709391,  0.27458377,  0.2472504 , -0.35999923,
       -0.22525291, -0.23536194,  0.05641002,  0.49812304,  0.31544091,
       -0.08528482, -0.09740877]), array([ 0.31039274,  0.02716343,  0.56703163,  0.25786291, -0.64304985,
       -0.41277413, -0.78723334, -0.13476649,  0.42697876,  1.04397762,
        0.14615429, -1.03820665]), array([-0.25004565, -0.18007841,  0.88157052,  0.37945338, -1.03943399,
       -0.13802685, -0.66788165, -0.10210536,  0.98877735,  0.49612683,
        0.68865723, -0.09179334]), array([ 0.07111795, -0.06691519,  0.43772114,  0.80710309, -0.67494468,
       -0.75536619, -0.61887493, -0.38756823,  0.87904981,  0.20231343,
       -0.50246995, -0.29017239]), array([-0.24454349,  0.45534426, -0.11334809,  0.53303203, -0.60055899,
        0.2397697 , -0.40828513, -0.02961796,  1.05035546,  1.29649878,
       -0.38845383,  0.31763682]), array([ 0.142547  ,  0.12649143,  0.58545039,  0.46527352, -0.74142787,
       -0.33540893, -0.82984118, -0.1345741 ,  0.86061389,  1.08744713,
       -0.01366835, -0.77339811]), array([-0.13645149, -0.09255077,  0.54736608,  0.36888254, -0.48467341,
       -0.18289348, -0.22562356,  0.35575762,  1.33664687,  0.05347568,
       -0.07040262, -0.79488568]), array([ 0.64699384, -0.06753474,  0.96307593,  0.39488863, -0.99368106,
       -0.87407022, -0.02852887,  0.58410524,  0.95339116,  0.71708019,
       -0.40939469,  0.04872493]), array([-0.19010775,  0.30166406,  0.56256428,  1.31422727, -0.22128875,
       -1.10767826, -0.26896598,  0.31807189,  1.03291413,  0.45913952,
        0.33361228, -0.08739072]), array([ 0.51711   ,  0.63825943,  0.67471574,  0.23429905, -0.16617678,
       -0.20020477, -0.68400429, -0.23672776,  1.30943356,  0.25567933,
        0.02261169, -0.1192848 ]), array([-0.19035094,  0.3829402 ,  0.21746398,  0.61420005, -0.58012055,
        0.04015476, -0.51936433,  0.00939179,  1.29080497,  0.99196438,
       -0.40844703, -0.01068021]), array([-0.1115209 ,  0.02118612,  0.54670732,  0.44445399, -0.48844361,
       -0.19547601, -0.34762281,  0.22681653,  1.30747418,  0.20756107,
       -0.14668856, -0.62012176]), array([-0.37780349,  0.43626831,  1.03073861,  0.7009829 , -0.28918334,
       -0.23355904, -0.77859805,  0.14729698,  0.85230787,  0.3833731 ,
       -0.49524845, -0.11843764]), array([ 0.23816686,  0.95461788,  0.35021606,  0.16389572, -1.23575409,
       -0.67272151, -0.54363591,  0.10330252,  0.90081685,  0.0582395 ,
       -0.13286468, -0.49640351]), array([ 0.11590152, -0.14432395,  0.32727202,  0.86219841, -0.6498273 ,
       -0.88779954, -0.62060844, -0.57362132,  0.59668674,  0.14411658,
       -0.58626557, -0.14019792])]
Labeling clusters
Clusters: defaultdict(<type 'int'>, {0.0: 836, 1.0: 172, 2.0: 149, 3.0: 285, 4.0: 52, 5.0: 84, 6.0: 143, 7.0: 143, 8.0: 118, 9.0: 342, 10.0: 354, 11.0: 664, 12.0: 128, 13.0: 237, 14.0: 104})
Centroid mean: [ 0.04058781  0.1973084   0.52354196  0.51920026 -0.61123757 -0.39608716
 -0.50429536  0.01347809  0.95229164  0.51416227 -0.13654354 -0.28746798]
Centroid variance: 1.18803495775
Cluster 11 (variance: 0.035899739395):
	0: (dist: 0.0438347974086) Arabian Nights (1942) (mid: 64921)
	1: (dist: 0.0438364446831) Flawless (1999) (mid: 3115)
	2: (dist: 0.0438368935257) Gone Fishin' (1997) (mid: 870)
	3: (dist: 0.0438376114677) Return of the Magnificent Seven, The (a.k.a. Return of the Seven) (1966) (mid: 4328)
	4: (dist: 0.0438380240116) Satan Bug, The (1965) (mid: 93183)
	5: (dist: 0.0438381540715) Dungeons & Dragons (2000) (mid: 3997)
	6: (dist: 0.0438381834521) Repo! The Genetic Opera (2008) (mid: 65868)
	7: (dist: 0.0438384038994) Beverly Hills Cop II (1987) (mid: 4084)
	8: (dist: 0.0438384066514) Hunter, The (1980) (mid: 4751)
	9: (dist: 0.0438386014237) Strangeland (1998) (mid: 2298)
Cluster 14 (variance: 0.127575277946):
	0: (dist: 0.159416703357) Sexy Nights of the Living Dead (1980) (mid: 96921)
	1: (dist: 0.159417192438) Wild at Heart (1990) (mid: 7044)
	2: (dist: 0.159445368443) Doom Generation, The (1995) (mid: 166)
	3: (dist: 0.159453947254) Ebola Syndrome, The (Yi boh laai beng duk) (1996) (mid: 32415)
	4: (dist: 0.161269706713) Straw Dogs (1971) (mid: 6301)
	5: (dist: 0.161286243907) Butterfly Kiss (1995) (mid: 696)
	6: (dist: 0.161287654913) Trouble Every Day (2001) (mid: 5153)
	7: (dist: 0.175598432577) Visitor Q (Bizita Q) (2001) (mid: 5909)
	8: (dist: 0.175603561548) Rape Me (Baise-moi) (2000) (mid: 4390)
	9: (dist: 0.175606508981) Freeway (1996) (mid: 1034)
Cluster 9 (variance: 0.13091017319):
	0: (dist: 0.117113858615) Nashville (1975) (mid: 2303)
	1: (dist: 0.117124160323) Chitty Chitty Bang Bang (1968) (mid: 7247)
	2: (dist: 0.117125654311) Red Dwarf, The (Nain rouge, Le) (1998) (mid: 2685)
	3: (dist: 0.117126813066) House (1986) (mid: 2148)
	4: (dist: 0.117127118301) Flashpoint (1984) (mid: 8901)
	5: (dist: 0.117128255522) Street Fighter (1994) (mid: 393)
	6: (dist: 0.117130176148) Ten Commandments, The (1923) (mid: 77433)
	7: (dist: 0.117130641729) Little Shop of Horrors (1986) (mid: 2746)
	8: (dist: 0.11713102839) Up (2009) (mid: 68954)
	9: (dist: 0.117131175443) Clash of the Titans (2010) (mid: 76175)
Cluster 6 (variance: 0.135932623699):
	0: (dist: 0.235039068047) Black Book (Zwartboek) (2006) (mid: 52042)
	1: (dist: 0.235039513499) Flatliners (1990) (mid: 3686)
	2: (dist: 0.235052777869) Rat (2000) (mid: 4269)
	3: (dist: 0.235072108743) Wassup Rockers (2005) (mid: 45521)
	4: (dist: 0.237514452636) Resident Evil: Afterlife (2010) (mid: 80363)
	5: (dist: 0.237526765791) Burial Ground (a.k.a. Zombie Horror) (a.k.a. Zombie 3) (Notti del Terrore, Le) (1981) (mid: 5210)
	6: (dist: 0.237527318977) Bio Zombie (Sun faa sau si) (1998) (mid: 47980)
	7: (dist: 0.237563112338) Four Flies on Grey Velvet (1971) (mid: 104392)
	8: (dist: 0.240028995565) CQ (2001) (mid: 5390)
	9: (dist: 0.240029552868) Shining, The (1980) (mid: 1258)
Cluster 1 (variance: 0.136549369634):
	0: (dist: 0.0869141422624) Boy Meets Girl (1984) (mid: 26498)
	1: (dist: 0.0869155364716) Wilby Wonderful (2004) (mid: 43528)
	2: (dist: 0.086916181368) Blue State (2007) (mid: 57964)
	3: (dist: 0.0869166851944) Royal Affair, A (Kongelig affære, En) (2012) (mid: 96911)
	4: (dist: 0.0869167201054) Rendezvous in Paris (Rendez-vous de Paris, Les) (1995) (mid: 807)
	5: (dist: 0.0869175331435) Sliding Doors (1998) (mid: 1680)
	6: (dist: 0.0869182796711) Myth of Fingerprints, The (1997) (mid: 3620)
	7: (dist: 0.0869185520258) Hot Rod (2007) (mid: 54256)
	8: (dist: 0.0869193420062) Darling (1965) (mid: 7130)
	9: (dist: 0.0869195660014) Role Models (2008) (mid: 63131)
Cluster 3 (variance: 0.184842874113):
	0: (dist: 0.211828530026) Disgrace (2008) (mid: 77266)
	1: (dist: 0.211829200312) Dangerous Liaisons (1988) (mid: 2020)
	2: (dist: 0.21182995257) Escape From Tomorrow (2013) (mid: 105801)
	3: (dist: 0.211830932537) Enfer, L' (1994) (mid: 264)
	4: (dist: 0.211831648616) Circle of Deceit (Die Fälschung) (1981) (mid: 91106)
	5: (dist: 0.211831752388) Lacombe Lucien (1974) (mid: 44947)
	6: (dist: 0.211832106978) Spirits of the Dead (1968) (mid: 775)
	7: (dist: 0.21183216622) Cape Fear (1962) (mid: 1344)
	8: (dist: 0.211832808361) Vera Drake (2004) (mid: 8951)
	9: (dist: 0.211832874648) Lust, Caution (Se, jie) (2007) (mid: 55253)
Cluster 4 (variance: 0.233439717867):
	0: (dist: 0.255832698895) Fortress 2 (2000) (mid: 102390)
	1: (dist: 0.255841806655) Lethal Weapon 2 (1989) (mid: 2001)
	2: (dist: 0.255848764103) Adventureland (2009) (mid: 67734)
	3: (dist: 0.25584962943) Money Train (1995) (mid: 20)
	4: (dist: 0.255861238419) Chase, The (1994) (mid: 31367)
	5: (dist: 0.255867015389) Men of War (1994) (mid: 69821)
	6: (dist: 0.255870113835) Urban Justice (2007) (mid: 66652)
	7: (dist: 0.255871944843) Pistol Whipped (2008) (mid: 66584)
	8: (dist: 0.255887459458) 7 Seconds (2005) (mid: 41736)
	9: (dist: 0.255905624125) Death Warrant (1990) (mid: 4199)
Cluster 10 (variance: 0.243514030896):
	0: (dist: 0.267487272112) Stigmata (1999) (mid: 2840)
	1: (dist: 0.267493257472) Nothing to Lose (1997) (mid: 7048)
	2: (dist: 0.267503183663) Stolen (2012) (mid: 98054)
	3: (dist: 0.267504474007) Kidulthood (2006) (mid: 51187)
	4: (dist: 0.267516876976) Bad Santa (2003) (mid: 6957)
	5: (dist: 0.267518247429) Repo Men (2010) (mid: 75985)
	6: (dist: 0.267530107762) We Own the Night (2007) (mid: 55272)
	7: (dist: 0.267537993539) The Outsider (2014) (mid: 107209)
	8: (dist: 0.267542473667) See No Evil, Hear No Evil (1989) (mid: 4662)
	9: (dist: 0.267553063514) Scream 3 (2000) (mid: 3273)
Cluster 2 (variance: 0.323285079076):
	0: (dist: 0.207066642322) Oliver! (1968) (mid: 1951)
	1: (dist: 0.207067427766) Mighty Heart, A (2007) (mid: 53921)
	2: (dist: 0.207068288559) Farewell, The (Abschied - Brechts letzter Sommer) (2000) (mid: 5050)
	3: (dist: 0.207068446993) Hunger (Sult) (1966) (mid: 58003)
	4: (dist: 0.207068981429) Mondays in the Sun (Lunes al sol, Los) (2002) (mid: 6571)
	5: (dist: 0.20706907593) Ip Man 2 (2010) (mid: 79553)
	6: (dist: 0.20706954303) Crazy Heart (2009) (mid: 73023)
	7: (dist: 0.207069669449) Head On (1998) (mid: 2775)
	8: (dist: 0.207070396176) Evangelion: 1.0 You Are (Not) Alone (Evangerion shin gekijôban: Jo) (2007) (mid: 70533)
	9: (dist: 0.207070461051) Vanya on 42nd Street (1994) (mid: 334)
Cluster 0 (variance: 0.351561495756):
	0: (dist: 0.430178555779) 9 Songs (2004) (mid: 33585)
	1: (dist: 0.430191325573) Jersey Girl (2004) (mid: 7366)
	2: (dist: 0.430193223701) Running Scared (2006) (mid: 43921)
	3: (dist: 0.43020193761) Man on the Moon (1999) (mid: 3174)
	4: (dist: 0.430209881013) This Girl's Life (2003) (mid: 31362)
	5: (dist: 0.433390547474) There Was a Crooked Man... (1970) (mid: 73111)
	6: (dist: 0.433399297301) Bad Lieutenant: Port of Call New Orleans (2009) (mid: 72405)
	7: (dist: 0.437171818926) Splendor in the Grass (1961) (mid: 3330)
	8: (dist: 0.437174081755) Election (1999) (mid: 2599)
	9: (dist: 0.437174969355) Highlander III: The Sorcerer (a.k.a. Highlander: The Final Dimension) (1994) (mid: 405)
Cluster 13 (variance: 0.355094111178):
	0: (dist: 0.188158711763) Rocky Horror Picture Show, The (1975) (mid: 2657)
	1: (dist: 0.188167932208) Secret Window (2004) (mid: 7347)
	2: (dist: 0.209337031238) Snow White and the Huntsman (2012) (mid: 94780)
	3: (dist: 0.210112971608) Manchurian Candidate, The (1962) (mid: 1267)
	4: (dist: 0.210117017424) Sherlock Holmes: A Game of Shadows (2011) (mid: 91542)
	5: (dist: 0.210118366173) Big Sleep, The (1946) (mid: 1284)
	6: (dist: 0.210118447958) Tingler, The (1959) (mid: 2781)
	7: (dist: 0.210118774993) Hamlet (2000) (mid: 3598)
	8: (dist: 0.210119511936) Sling Blade (1996) (mid: 1358)
	9: (dist: 0.210120264114) Dead Man's Shoes (2004) (mid: 40412)
Cluster 12 (variance: 0.362116401284):
	0: (dist: 0.201591535399) Abandoned, The (2006) (mid: 51666)
	1: (dist: 0.208083098617) Austin Powers: International Man of Mystery (1997) (mid: 1517)
	2: (dist: 0.208086108325) Rocky III (1982) (mid: 2410)
	3: (dist: 0.208086894547) Monkeybone (2001) (mid: 4158)
	4: (dist: 0.208087306126) Diving Bell and the Butterfly, The (Scaphandre et le papillon, Le) (2007) (mid: 55814)
	5: (dist: 0.208088716014) Rocky IV (1985) (mid: 2411)
	6: (dist: 0.208089209465) Holcroft Covenant, The (1985) (mid: 4983)
	7: (dist: 0.208089839739) Science of Sleep, The (La science des rêves) (2006) (mid: 48082)
	8: (dist: 0.20808998174) Shallow Hal (2001) (mid: 4890)
	9: (dist: 0.208092225786) Rollerball (1975) (mid: 5522)
Cluster 5 (variance: 0.378394833387):
	0: (dist: 0.300386536381) Trainspotting (1996) (mid: 778)
	1: (dist: 0.303600666483) Beginners (2010) (mid: 87304)
	2: (dist: 0.303603841305) Le Week-End (2013) (mid: 110796)
	3: (dist: 0.303609565413) Synecdoche, New York (2008) (mid: 62511)
	4: (dist: 0.303612730352) American Beauty (1999) (mid: 2858)
	5: (dist: 0.303617148958) Jack Goes Boating (2010) (mid: 81639)
	6: (dist: 0.371388521411) 16 Blocks (2006) (mid: 43936)
	7: (dist: 0.371392062631) Persepolis (2007) (mid: 55442)
	8: (dist: 0.37139547576) Footprints on the Moon (Le orme) (Primal Impulse) (1975) (mid: 107370)
	9: (dist: 0.371398966748) Analyze That (2002) (mid: 5900)
Cluster 7 (variance: 0.395910126458):
	0: (dist: 0.143428931479) Picture of Dorian Gray, The (1945) (mid: 8482)
	1: (dist: 0.143431629214) Bitter Moon (1992) (mid: 347)
	2: (dist: 0.143433263572) Lookout, The (2007) (mid: 52241)
	3: (dist: 0.143435262071) The Chumscrubber (2005) (mid: 34523)
	4: (dist: 0.143435373328) Judgement in Stone, A (Cérémonie, La) (1995) (mid: 1406)
	5: (dist: 0.143436172244) Color of Paradise, The (Rang-e khoda) (1999) (mid: 3456)
	6: (dist: 0.143436778259) Jane Austen Book Club, The (2007) (mid: 55451)
	7: (dist: 0.143436985033) Stranger than Fiction (2006) (mid: 46976)
	8: (dist: 0.143437121884) Man of Marble (Czlowiek z Marmuru) (1977) (mid: 6921)
	9: (dist: 0.143438169838) Youngblood (1986) (mid: 4355)
Cluster 8 (variance: 0.424424050198):
	0: (dist: 0.191170236055) Tree of Wooden Clogs, The (L'albero degli zoccoli) (1978) (mid: 34548)
	1: (dist: 0.191173614939) Day of Wrath (Vredens dag) (1943) (mid: 25898)
	2: (dist: 0.191173790526) Beauty and the Beast (1991) (mid: 595)
	3: (dist: 0.191174613491) Witch Who Came from the Sea, The (1976) (mid: 81574)
	4: (dist: 0.191175713777) Amityville Horror, The (1979) (mid: 1327)
	5: (dist: 0.19117727709) Mexican, The (2001) (mid: 4161)
	6: (dist: 0.191177417165) Milarepa (2006) (mid: 99895)
	7: (dist: 0.191177427116) Maurice (1987) (mid: 3094)
	8: (dist: 0.191178792281) Deluge, The (Potop) (1974) (mid: 8660)
	9: (dist: 0.191178964839) Adam & Steve (2005) (mid: 46194)
Training a latent tree
DecisionTreeModel classifier of depth 8 with 141 nodes
  If (feature 8 <= 0.7135974168777466)
   If (feature 6 <= -0.46493858098983765)
    If (feature 11 <= -0.5226573944091797)
     If (feature 8 <= 0.5681361556053162)
      Predict: 1.0
     Else (feature 8 > 0.5681361556053162)
      If (feature 4 <= -1.0947386026382446)
       If (feature 0 <= 0.2626788914203644)
        Predict: 1.0
       Else (feature 0 > 0.2626788914203644)
        Predict: 13.0
      Else (feature 4 > -1.0947386026382446)
       Predict: 5.0
    Else (feature 11 > -0.5226573944091797)
     If (feature 1 <= -0.049068473279476166)
      If (feature 5 <= -0.6227505803108215)
       Predict: 14.0
      Else (feature 5 > -0.6227505803108215)
       If (feature 0 <= -0.15153399109840393)
        Predict: 2.0
       Else (feature 0 > -0.15153399109840393)
        Predict: 3.0
     Else (feature 1 > -0.049068473279476166)
      If (feature 3 <= 0.5039361715316772)
       If (feature 1 <= 0.4229162037372589)
        If (feature 1 <= 0.2538799047470093)
         Predict: 0.0
        Else (feature 1 > 0.2538799047470093)
         If (feature 0 <= -0.4217498004436493)
          Predict: 2.0
         Else (feature 0 > -0.4217498004436493)
          Predict: 5.0
       Else (feature 1 > 0.4229162037372589)
        Predict: 13.0
      Else (feature 3 > 0.5039361715316772)
       If (feature 2 <= 0.31455570459365845)
        Predict: 3.0
       Else (feature 2 > 0.31455570459365845)
        Predict: 12.0
   Else (feature 6 > -0.46493858098983765)
    If (feature 1 <= 0.6642468571662903)
     If (feature 7 <= 0.41267892718315125)
      If (feature 3 <= 0.723754346370697)
       Predict: 0.0
      Else (feature 3 > 0.723754346370697)
       Predict: 8.0
     Else (feature 7 > 0.41267892718315125)
      If (feature 0 <= -0.22386163473129272)
       Predict: 8.0
      Else (feature 0 > -0.22386163473129272)
       Predict: 7.0
    Else (feature 1 > 0.6642468571662903)
     If (feature 0 <= -0.3233359754085541)
      Predict: 8.0
     Else (feature 0 > -0.3233359754085541)
      Predict: 13.0
  Else (feature 8 > 0.7135974168777466)
   If (feature 11 <= -0.46884220838546753)
    If (feature 5 <= -0.2326156049966812)
     If (feature 1 <= 0.511510968208313)
      If (feature 7 <= 0.19241565465927124)
       If (feature 9 <= 0.5521262884140015)
        If (feature 3 <= 0.5039361715316772)
         If (feature 8 <= 0.790435791015625)
          Predict: 1.0
         Else (feature 8 > 0.790435791015625)
          Predict: 9.0
        Else (feature 3 > 0.5039361715316772)
         If (feature 2 <= 0.7461099624633789)
          Predict: 3.0
         Else (feature 2 > 0.7461099624633789)
          Predict: 12.0
       Else (feature 9 > 0.5521262884140015)
        If (feature 3 <= 1.1253873109817505)
         If (feature 3 <= 0.20584744215011597)
          Predict: 1.0
         Else (feature 3 > 0.20584744215011597)
          Predict: 5.0
        Else (feature 3 > 1.1253873109817505)
         Predict: 8.0
      Else (feature 7 > 0.19241565465927124)
       If (feature 2 <= 0.14390259981155396)
        Predict: 8.0
       Else (feature 2 > 0.14390259981155396)
        Predict: 6.0
     Else (feature 1 > 0.511510968208313)
      If (feature 4 <= -0.7767813205718994)
       Predict: 13.0
      Else (feature 4 > -0.7767813205718994)
       Predict: 9.0
    Else (feature 5 > -0.2326156049966812)
     If (feature 6 <= -0.24856311082839966)
      If (feature 6 <= -0.5246866941452026)
       If (feature 6 <= -0.6905349493026733)
        Predict: 5.0
       Else (feature 6 > -0.6905349493026733)
        If (feature 0 <= -0.4217498004436493)
         Predict: 12.0
        Else (feature 0 > -0.4217498004436493)
         If (feature 0 <= -0.2340286672115326)
          Predict: 2.0
         Else (feature 0 > -0.2340286672115326)
          Predict: 1.0
      Else (feature 6 > -0.5246866941452026)
       If (feature 9 <= -0.005957439541816711)
        Predict: 6.0
       Else (feature 9 > -0.005957439541816711)
        If (feature 0 <= -0.01722869835793972)
         Predict: 11.0
        Else (feature 0 > -0.01722869835793972)
         Predict: 9.0
     Else (feature 6 > -0.24856311082839966)
      If (feature 11 <= -0.6636045575141907)
       Predict: 6.0
      Else (feature 11 > -0.6636045575141907)
       Predict: 11.0
   Else (feature 11 > -0.46884220838546753)
    If (feature 9 <= 0.7429152131080627)
     If (feature 1 <= 0.3805902302265167)
      If (feature 7 <= -0.15536928176879883)
       If (feature 10 <= -0.20436806976795197)
        If (feature 2 <= 0.3586215078830719)
         If (feature 4 <= -0.679163932800293)
          Predict: 3.0
         Else (feature 4 > -0.679163932800293)
          Predict: 14.0
        Else (feature 2 > 0.3586215078830719)
         If (feature 0 <= -0.2340286672115326)
          Predict: 12.0
         Else (feature 0 > -0.2340286672115326)
          Predict: 3.0
       Else (feature 10 > -0.20436806976795197)
        Predict: 2.0
      Else (feature 7 > -0.15536928176879883)
       If (feature 5 <= -0.2326156049966812)
        If (feature 0 <= 0.19701698422431946)
         If (feature 5 <= -0.7457231879234314)
          Predict: 8.0
         Else (feature 5 > -0.7457231879234314)
          Predict: 12.0
        Else (feature 0 > 0.19701698422431946)
         If (feature 5 <= -0.6727284789085388)
          Predict: 7.0
         Else (feature 5 > -0.6727284789085388)
          Predict: 11.0
       Else (feature 5 > -0.2326156049966812)
        If (feature 4 <= -0.6544198393821716)
         Predict: 2.0
        Else (feature 4 > -0.6544198393821716)
         If (feature 2 <= 0.7461099624633789)
          Predict: 0.0
         Else (feature 2 > 0.7461099624633789)
          Predict: 12.0
     Else (feature 1 > 0.3805902302265167)
      If (feature 0 <= 0.19701698422431946)
       If (feature 2 <= 0.8728896975517273)
        If (feature 4 <= -0.9549651741981506)
         Predict: 13.0
        Else (feature 4 > -0.9549651741981506)
         If (feature 5 <= -0.8241271376609802)
          Predict: 8.0
         Else (feature 5 > -0.8241271376609802)
          Predict: 10.0
       Else (feature 2 > 0.8728896975517273)
        Predict: 12.0
      Else (feature 0 > 0.19701698422431946)
       If (feature 4 <= -0.7767813205718994)
        If (feature 1 <= 0.6642468571662903)
         Predict: 7.0
        Else (feature 1 > 0.6642468571662903)
         Predict: 13.0
       Else (feature 4 > -0.7767813205718994)
        If (feature 5 <= -0.7457231879234314)
         If (feature 0 <= 0.28302422165870667)
          Predict: 8.0
         Else (feature 0 > 0.28302422165870667)
          Predict: 14.0
        Else (feature 5 > -0.7457231879234314)
         If (feature 6 <= -0.8243521451950073)
          Predict: 3.0
         Else (feature 6 > -0.8243521451950073)
          Predict: 9.0
    Else (feature 9 > 0.7429152131080627)
     If (feature 2 <= 0.03737841546535492)
      If (feature 11 <= 0.028640510514378548)
       If (feature 1 <= 0.06040939688682556)
        Predict: 10.0
       Else (feature 1 > 0.06040939688682556)
        Predict: 13.0
      Else (feature 11 > 0.028640510514378548)
       Predict: 4.0
     Else (feature 2 > 0.03737841546535492)
      If (feature 5 <= -0.3595007061958313)
       If (feature 0 <= -0.01722869835793972)
        If (feature 0 <= -0.2340286672115326)
         Predict: 8.0
        Else (feature 0 > -0.2340286672115326)
         Predict: 10.0
       Else (feature 0 > -0.01722869835793972)
        Predict: 7.0
      Else (feature 5 > -0.3595007061958313)
       If (feature 10 <= -0.001163058215752244)
        If (feature 7 <= 0.22935542464256287)
         Predict: 10.0
        Else (feature 7 > 0.22935542464256287)
         If (feature 0 <= -0.2340286672115326)
          Predict: 10.0
         Else (feature 0 > -0.2340286672115326)
          Predict: 4.0
       Else (feature 10 > -0.001163058215752244)
        Predict: 2.0

Done, making predictions
Accuracy of latent tree on training set: 0.990468928708
Accuracy of latent tree on test set: 0.97138047138
Building meta training set
Training a meta tree
DecisionTreeModel classifier of depth 8 with 105 nodes
  If (average_rating <= 2.0)
   Predict: 0.0
  Else (average_rating > 2.0)
   If (Isn't imdb_keywords:f-word)
    If (Isn't tvtropes:oh crap)
     If (Isn't imdb_keywords:chase)
      If (Isn't imdb_keywords:depression)
       If (Isn't imdb_keywords:rape)
        If (Isn't imdb_keywords:accident)
         If (Isn't movielens_tags:murder)
          Predict: 2.0
         Else (Is movielens_tags:murder)
          Predict: 13.0
        Else (Is imdb_keywords:accident)
         Predict: 7.0
       Else (Is imdb_keywords:rape)
        If (average_rating <= 3.2929878601195868)
         If (Isn't imdb_keywords:u.s.-army)
          Predict: 14.0
         Else (Is imdb_keywords:u.s.-army)
          Predict: 3.0
        Else (average_rating > 3.2929878601195868)
         If (Isn't imdb_keywords:curse)
          Predict: 3.0
         Else (Is imdb_keywords:curse)
          Predict: 8.0
      Else (Is imdb_keywords:depression)
       If (Isn't imdb_keywords:hope)
        If (Isn't imdb_keywords:rape)
         If (Isn't imdb_keywords:curse)
          Predict: 1.0
         Else (Is imdb_keywords:curse)
          Predict: 8.0
        Else (Is imdb_keywords:rape)
         If (average_rating <= 3.5290663534938345)
          Predict: 1.0
         Else (average_rating > 3.5290663534938345)
          Predict: 5.0
       Else (Is imdb_keywords:hope)
        If (Isn't imdb_keywords:demonstration)
         Predict: 5.0
        Else (Is imdb_keywords:demonstration)
         If (year <= 1986.0)
          Predict: 13.0
         Else (year > 1986.0)
          Predict: 1.0
     Else (Is imdb_keywords:chase)
      If (Isn't imdb_keywords:rape)
       If (Isn't movielens_tags:murder)
        If (Isn't imdb_keywords:bathroom)
         If (Isn't imdb_keywords:snake)
          Predict: 11.0
         Else (Is imdb_keywords:snake)
          Predict: 6.0
        Else (Is imdb_keywords:bathroom)
         If (average_rating <= 2.9733695652173915)
          Predict: 6.0
         Else (average_rating > 2.9733695652173915)
          Predict: 1.0
       Else (Is movielens_tags:murder)
        If (Isn't imdb_keywords:accident)
         If (Isn't movielens_tags:less than 300 ratings)
          Predict: 13.0
         Else (Is movielens_tags:less than 300 ratings)
          Predict: 6.0
        Else (Is imdb_keywords:accident)
         Predict: 7.0
      Else (Is imdb_keywords:rape)
       If (Isn't imdb_keywords:reverse-footage)
        If (Isn't imdb_keywords:curse)
         If (Isn't imdb_keywords:woman-on-top)
          Predict: 3.0
         Else (Is imdb_keywords:woman-on-top)
          Predict: 13.0
        Else (Is imdb_keywords:curse)
         If (year <= 1986.0)
          Predict: 2.0
         Else (year > 1986.0)
          Predict: 8.0
       Else (Is imdb_keywords:reverse-footage)
        If (Isn't movielens_genre:Romance)
         Predict: 12.0
        Else (Is movielens_genre:Romance)
         Predict: 7.0
    Else (Is tvtropes:oh crap)
     If (Isn't movielens_tags:murder)
      If (Isn't imdb_keywords:rape)
       If (Isn't imdb_keywords:reverse-footage)
        If (Isn't imdb_keywords:hope)
         If (Isn't imdb_keywords:depression)
          Predict: 9.0
         Else (Is imdb_keywords:depression)
          Predict: 5.0
        Else (Is imdb_keywords:hope)
         If (year <= 2013.0)
          Predict: 2.0
         Else (year > 2013.0)
          Predict: 9.0
       Else (Is imdb_keywords:reverse-footage)
        If (Isn't imdb_keywords:hanging)
         Predict: 12.0
        Else (Is imdb_keywords:hanging)
         If (year <= 1984.0)
          Predict: 8.0
         Else (year > 1984.0)
          Predict: 9.0
      Else (Is imdb_keywords:rape)
       If (Isn't imdb_keywords:mirror)
        Predict: 3.0
       Else (Is imdb_keywords:mirror)
        If (year <= 1995.0)
         Predict: 12.0
        Else (year > 1995.0)
         Predict: 5.0
     Else (Is movielens_tags:murder)
      Predict: 13.0
   Else (Is imdb_keywords:f-word)
    If (Isn't imdb_keywords:kissing-while-having-sex)
     If (Isn't imdb_keywords:depression)
      If (Isn't movielens_tags:murder)
       If (Isn't imdb_keywords:hope)
        If (Isn't imdb_keywords:curse)
         If (average_rating <= 2.999745352686529)
          Predict: 10.0
         Else (average_rating > 2.999745352686529)
          Predict: 10.0
        Else (Is imdb_keywords:curse)
         Predict: 8.0
       Else (Is imdb_keywords:hope)
        If (Isn't movielens_tags:atmospheric)
         Predict: 2.0
        Else (Is movielens_tags:atmospheric)
         Predict: 10.0
      Else (Is movielens_tags:murder)
       If (Isn't imdb_keywords:champagne)
        Predict: 13.0
       Else (Is imdb_keywords:champagne)
        If (Isn't movielens_genre:Action)
         Predict: 10.0
        Else (Is movielens_genre:Action)
         Predict: 7.0
     Else (Is imdb_keywords:depression)
      If (Isn't imdb_keywords:accident)
       Predict: 5.0
      Else (Is imdb_keywords:accident)
       Predict: 7.0
    Else (Is imdb_keywords:kissing-while-having-sex)
     If (Isn't imdb_keywords:accident)
      If (Isn't movielens_genre:Fantasy)
       Predict: 4.0
      Else (Is movielens_genre:Fantasy)
       If (year <= 2012.0)
        Predict: 10.0
       Else (year > 2012.0)
        Predict: 8.0
     Else (Is imdb_keywords:accident)
      Predict: 7.0

Done, making predictions
Accuracy of meta tree on training set: 0.89391634981
Accuracy of meta tree on test set: 0.867061812024
26 features used
15 clusters found
Processing cluster 0.0
Traceback (most recent call last):
  File "/longterm/sophiak/fop_qii/product_clustering.py", line 453, in <module>
    main()
  File "/longterm/sophiak/fop_qii/product_clustering.py", line 338, in main
    classifier=True, class_of_interest=cluster)
  File "/longterm/sophiak/fop_qii/tree_qii.py", line 101, in get_tree_qii
    class_of_interest=class_of_interest)
  File "/longterm/sophiak/fop_qii/common_utils.py", line 126, in compute_regression_qii
    if signed_error == 0:
UnboundLocalError: local variable 'signed_error' referenced before assignment
